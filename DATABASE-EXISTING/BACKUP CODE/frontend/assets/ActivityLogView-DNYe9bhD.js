import{d as J,r as m,b as f,w as s,e as l,f as t,g as o,h as d,t as r,j as y,i as z,k as q,F as P,a as K,l as c,_ as R}from"./index-DDZ3D2Zd.js";const Q={class:"header-section d-flex flex-column flex-sm-row align-start align-sm-center mb-6 mb-md-8"},X={class:"header-content d-flex align-center mb-4 mb-sm-0"},Y={class:"header-avatar-wrapper"},Z={class:"avatar-gradient-bg"},tt={class:"card-header pa-4 pa-md-6"},et={class:"d-flex align-center justify-space-between"},at={class:"d-flex align-center"},st={class:"header-icon-wrapper me-3"},it={class:"card-subtitle text-caption text-medium-emphasis mb-0"},ot={class:"table-container"},lt={class:"user-cell d-flex align-center py-2"},nt={class:"user-avatar-wrapper me-3"},rt={class:"user-avatar-bg"},dt={class:"user-initial"},ct={class:"user-info"},mt={class:"user-name font-weight-bold text-body-2"},ut={class:"user-email text-caption text-medium-emphasis"},pt={class:"timestamp-cell"},_t={class:"timestamp-primary text-body-2 font-weight-medium"},vt={class:"timestamp-secondary text-caption text-medium-emphasis"},ft={class:"details-cell text-center"},gt={key:1,class:"text-disabled"},ht={class:"loading-container d-flex flex-column align-center justify-center pa-8"},bt={class:"no-data-container d-flex flex-column align-center justify-center pa-8"},xt={class:"dialog-header pa-4 pa-md-6"},yt={class:"d-flex align-center"},wt={class:"dialog-icon-wrapper me-3"},kt={class:"dialog-content"},Ct={class:"detail-content w-100"},Dt={class:"detail-key text-primary font-weight-bold text-body-2 mb-1"},zt={class:"detail-value text-body-2 text-medium-emphasis"},Pt={class:"dialog-actions pa-4 pa-md-6"},Tt=J({__name:"ActivityLogView",setup(At){const w=m([]),_=m(!0),g=m(0),h=m(10),u=m(!1),p=m(null),T=[{title:"Pengguna",key:"user",sortable:!1,width:"30%"},{title:"Aksi",key:"action",sortable:!1,width:"25%"},{title:"Waktu",key:"timestamp",sortable:!1,width:"25%"},{title:"Detail",key:"details",sortable:!1,align:"center",width:"20%"}];async function k({page:a,itemsPerPage:e}){_.value=!0;try{const n=await K.get("/activity-logs",{params:{skip:(a-1)*e,limit:e}});w.value=n.data.items,g.value=n.data.total}catch(n){console.error("Gagal mengambil data log aktivitas:",n)}finally{_.value=!1}}function A(){k({page:1,itemsPerPage:h.value})}function L(a){return a.startsWith("POST")?"success":a.startsWith("PATCH")?"warning":a.startsWith("DELETE")?"error":a.startsWith("GET")?"info":"grey"}function V(a){return a.startsWith("POST")?"mdi-plus-circle-outline":a.startsWith("PATCH")?"mdi-pencil-outline":a.startsWith("DELETE")?"mdi-delete-outline":a.startsWith("GET")?"mdi-eye-outline":"mdi-cog-outline"}function E(a){try{p.value=JSON.parse(a)}catch{p.value={raw_data:a}}u.value=!0}function W(a){return a.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function j(a){return a==null?"-":typeof a=="object"?JSON.stringify(a,null,2):String(a)}function S(a){return new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}function B(a){return new Date(a).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}return(a,e)=>{const n=l("v-icon"),C=l("v-avatar"),v=l("v-btn"),b=l("v-divider"),N=l("v-chip"),O=l("v-progress-circular"),I=l("v-data-table-server"),D=l("v-card"),U=l("v-list-item"),G=l("v-list"),M=l("v-spacer"),$=l("v-dialog"),F=l("v-container");return c(),f(F,{fluid:"",class:"activity-log-container pa-4 pa-md-6"},{default:s(()=>[t("div",Q,[t("div",X,[t("div",Y,[o(C,{class:"header-avatar me-4",size:"56",color:"transparent"},{default:s(()=>[t("div",Z,[o(n,{color:"white",size:"32"},{default:s(()=>e[4]||(e[4]=[d("mdi-history")])),_:1,__:[4]})])]),_:1})]),e[5]||(e[5]=t("div",{class:"header-text"},[t("h1",{class:"header-title text-h4 text-sm-h3 font-weight-bold mb-1"},"Log Aktivitas"),t("p",{class:"header-subtitle text-subtitle-1 text-body-2 text-medium-emphasis mb-0"}," Melacak semua perubahan data penting dalam sistem ")],-1))])]),o(D,{class:"activity-card",elevation:"0",rounded:"xl"},{default:s(()=>[t("div",tt,[t("div",et,[t("div",at,[t("div",st,[o(n,{color:"primary",size:"26"},{default:s(()=>e[6]||(e[6]=[d("mdi-format-list-bulleted-square")])),_:1,__:[6]})]),t("div",null,[e[7]||(e[7]=t("h2",{class:"card-title text-h6 font-weight-bold mb-0"},"Riwayat Aktivitas Pengguna",-1)),t("p",it,r(g.value)+" total aktivitas tercatat ",1)])]),o(v,{icon:"mdi-refresh",variant:"text",size:"small",color:"primary",loading:_.value,onClick:A,class:"refresh-btn"},null,8,["loading"])])]),o(b,{class:"card-divider"}),t("div",ot,[o(I,{"items-per-page":h.value,"onUpdate:itemsPerPage":e[0]||(e[0]=i=>h.value=i),headers:T,items:w.value,"items-length":g.value,loading:_.value,"onUpdate:options":k,class:"activity-table","no-data-text":"Belum ada aktivitas yang tercatat","loading-text":"Memuat data log...","items-per-page-options":[10,25,50,100]},{"item.user":s(({item:i})=>[t("div",lt,[t("div",nt,[o(C,{size:"36",class:"user-avatar"},{default:s(()=>[t("div",rt,[t("span",dt,r(i.user.name.charAt(0).toUpperCase()),1)])]),_:2},1024)]),t("div",ct,[t("div",mt,r(i.user.name),1),t("div",ut,r(i.user.email),1)])])]),"item.action":s(({item:i})=>[o(N,{color:L(i.action),variant:"flat",size:"small",class:"action-chip font-weight-bold",label:""},{default:s(()=>[o(n,{start:"",size:"16"},{default:s(()=>[d(r(V(i.action)),1)]),_:2},1024),d(" "+r(i.action),1)]),_:2},1032,["color"])]),"item.timestamp":s(({item:i})=>[t("div",pt,[t("div",_t,r(S(i.timestamp)),1),t("div",vt,r(B(i.timestamp)),1)])]),"item.details":s(({item:i})=>[t("div",ft,[i.details?(c(),f(v,{key:0,icon:"",variant:"text",size:"small",color:"primary",class:"details-btn",onClick:x=>E(i.details)},{default:s(()=>[o(n,{size:"20"},{default:s(()=>e[8]||(e[8]=[d("mdi-code-json")])),_:1,__:[8]})]),_:2},1032,["onClick"])):(c(),y("span",gt,"-"))])]),loading:s(()=>[t("div",ht,[o(O,{indeterminate:"",color:"primary",size:"48",width:"4"}),e[9]||(e[9]=t("p",{class:"text-body-2 text-medium-emphasis mt-4 mb-0"},"Memuat data log...",-1))])]),"no-data":s(()=>[t("div",bt,[o(n,{size:"64",color:"disabled",class:"mb-4"},{default:s(()=>e[10]||(e[10]=[d("mdi-history-off")])),_:1,__:[10]}),e[11]||(e[11]=t("p",{class:"text-h6 font-weight-medium text-medium-emphasis mb-2"},"Belum ada aktivitas",-1)),e[12]||(e[12]=t("p",{class:"text-body-2 text-disabled mb-0"},"Data aktivitas akan muncul setelah ada perubahan sistem",-1))])]),_:1},8,["items-per-page","items","items-length","loading"])])]),_:1}),o($,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=i=>u.value=i),"max-width":"600",class:"details-dialog"},{default:s(()=>[o(D,{class:"dialog-card",rounded:"xl"},{default:s(()=>[t("div",xt,[t("div",yt,[t("div",wt,[o(n,{color:"primary",size:"24"},{default:s(()=>e[13]||(e[13]=[d("mdi-code-braces")])),_:1,__:[13]})]),e[14]||(e[14]=t("div",{class:"flex-grow-1"},[t("h3",{class:"dialog-title text-h6 font-weight-bold mb-0"},"Detail Aktivitas"),t("p",{class:"dialog-subtitle text-caption text-medium-emphasis mb-0"},"Informasi lengkap perubahan data")],-1)),o(v,{icon:"mdi-close",variant:"text",size:"small",color:"grey",onClick:e[1]||(e[1]=i=>u.value=!1),class:"close-btn"})])]),o(b,{class:"dialog-divider"}),t("div",kt,[p.value?(c(),f(G,{key:0,class:"details-list"},{default:s(()=>[(c(!0),y(P,null,q(p.value,(i,x,H)=>(c(),y(P,{key:x},[o(U,{class:"detail-item px-4 px-md-6 py-3"},{default:s(()=>[t("div",Ct,[t("div",Dt,r(W(x)),1),t("div",zt,r(j(i)),1)])]),_:2},1024),H<Object.keys(p.value).length-1?(c(),f(b,{key:0,class:"detail-divider"})):z("",!0)],64))),128))]),_:1})):z("",!0)]),t("div",Pt,[o(M),o(v,{variant:"tonal",color:"primary",onClick:e[2]||(e[2]=i=>u.value=!1),class:"close-dialog-btn"},{default:s(()=>e[15]||(e[15]=[d(" Tutup ")])),_:1,__:[15]})])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Vt=R(Tt,[["__scopeId","data-v-585475d8"]]);export{Vt as default};
