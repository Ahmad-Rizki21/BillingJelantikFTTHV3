import{d as pe,u as ge,c as C,r as d,o as ve,q as _e,p as fa,n as ce,a as b,b as K,w as t,e as m,f as s,g as e,h as o,i as S,s as fe,j as x,k as Ba,t as u,F as ya,m as Na,l as _,_ as ye}from"./index-DDZ3D2Zd.js";import{d as be}from"./debounce-BMmXVQ06.js";const ke={class:"d-flex align-center mb-6 page-header"},we={class:"d-flex align-center"},xe={class:"header-actions"},he=["href"],Ve={class:"d-flex flex-wrap align-center gap-4 pa-4"},Pe={key:0,class:"selection-toolbar pa-4"},Le={class:"font-weight-bold text-primary"},De={class:"d-block d-md-none"},ze={key:0,class:"text-center py-12"},Ce={key:1,class:"pa-8 text-center"},Se={key:2,class:"pa-2"},Te={class:"d-flex align-center mb-3"},Ue={class:"flex-grow-1"},Be={class:"text-body-1 font-weight-bold"},Ne={class:"text-caption text-medium-emphasis"},Ae={class:"text-body-2 font-weight-bold text-success"},$e={class:"text-body-2"},je={class:"d-flex gap-2 mt-3"},Ie={key:0,class:"text-center pa-4"},Ee={class:"table-responsive-wrapper d-none d-md-block"},Fe={class:"font-weight-bold"},qe={class:"text-caption text-medium-emphasis"},Me={class:"text-caption",style:{"max-width":"200px","white-space":"normal"}},He={class:"font-weight-medium"},Re={class:"font-weight-bold text-right"},Oe={class:"font-weight-bold text-right"},Ge={class:"d-flex justify-center ga-2"},Je={class:"header-content"},Ke={class:"header-title"},Ye={class:"header-subtitle"},Qe={class:"form-section"},We={class:"section-title"},Xe={class:"form-section"},Ze={class:"section-title"},at={key:0,class:"mt-4"},et={class:"mt-4"},tt={class:"text-body-2"},lt={class:"ms-2 mt-1"},nt={class:"form-section"},ot={class:"section-title"},st={class:"delete-header text-center pa-8"},it={class:"text-body-1 text-medium-emphasis mb-0"},rt={class:"text-primary"},dt={class:"delete-header text-center pa-8"},ut={class:"text-body-1 text-medium-emphasis mb-0"},ba=15,mt=pe({__name:"LanggananView",setup(pt){const{mobile:ka}=ge(),Aa=C(()=>ka.value?"compact":"comfortable"),Y=d(null),sa=d(1),ia=d(!0),Q=d(!1),f=d([]),F=d([]),q=d([]),T=d([]),W=d(!0),ra=d(!0),da=d(!1),ua=d(!1),U=d(!1),M=d(!1),X=d(!1),y=d(-1),wa=d(!1),h=d([]),H=d(!1),Z=d(!1),ma=d(!1),L=d([]),V=d([]),B=d(""),N=d(""),A=d(null),$=d(null),$a=d(["Aktif","Suspended","Berhenti"]),D=d(!1),aa=d(0),pa=d(0);function ja(n){V.value=[],Array.isArray(n)?L.value=n:n?L.value=[n]:L.value=[]}function xa(){Z.value=!1,L.value=[],V.value=[]}const ga={pelanggan_id:void 0,paket_layanan_id:void 0,status:"Aktif",tgl_jatuh_tempo:null,tgl_invoice_terakhir:null,metode_pembayaran:"Otomatis",harga_awal:0,tgl_mulai_langganan:null},r=d({...ga}),R=d(null),Ia=d(null),Ea=C(()=>y.value>-1),ea={required:n=>!!n||"Field ini wajib diisi"},Fa=[{title:"No",key:"nomor",sortable:!1,width:"5%"},{title:"Nama Pelanggan",key:"pelanggan.nama",sortable:!0,width:"15%"},{title:"Alamat",key:"pelanggan.alamat",sortable:!1,width:"15%"},{title:"Paket Layanan",key:"paket_layanan_id",width:"15%"},{title:"Metode Bayar",key:"metode_pembayaran",align:"center",width:"15%"},{title:"Harga",key:"harga_final",align:"end"},{title:"Status",key:"status",align:"center",width:"20%"},{title:"Jatuh Tempo",key:"tgl_jatuh_tempo",align:"center",width:"20%"},{title:"Actions",key:"actions",sortable:!1,align:"center",width:"20%"}],qa=C(()=>y.value===-1?"Tambah Langganan Baru":"Edit Langganan"),ha=C(()=>!!(r.value.pelanggan_id&&r.value.paket_layanan_id&&r.value.status&&r.value.harga_awal>0));ve(()=>{P(),Pa(),Ya(),window.addEventListener("new-notification",Va)}),_e(()=>{window.removeEventListener("new-notification",Va)});const Ma=C(()=>Y.value?Y.value:Ka.value);fa(()=>r.value.pelanggan_id,async n=>{if(r.value.paket_layanan_id=void 0,da.value=!1,!n){T.value=[];return}try{const i=(await b.get(`/pelanggan/${n}`)).data;if(!i||!i.id_brand||!i.layanan){T.value=[];return}const g=i.id_brand,v=i.layanan;T.value=q.value.filter(k=>k.id_brand===g);const p=T.value.find(k=>k.nama_paket===v);p&&(r.value.paket_layanan_id=p.id,da.value=!0)}catch(a){console.error("Gagal mengambil detail pelanggan:",a),T.value=[]}},{immediate:!0});const Va=async n=>{const i=n.detail;if(i.type==="new_technical_data"&&i.data.pelanggan_id){const g=i.data.pelanggan_id;Ia.value=g,await Pa(),await P();const v=F.value.find(p=>p.id===g);v&&(Y.value=[v]),O(),ce(()=>{r.value.pelanggan_id=g})}};fa(()=>[r.value.metode_pembayaran,r.value.paket_layanan_id,r.value.pelanggan_id,r.value.tgl_mulai_langganan,D.value],async([n,a,i,g,v])=>{if(aa.value=0,pa.value=0,n==="Otomatis"&&(D.value=!1),n==="Prorate"&&!g&&y.value===-1)return;if(!M.value||!a||!i){y.value===-1&&(r.value.harga_awal=0);return}let p="/langganan/calculate-price";n==="Prorate"&&v&&(p="/langganan/calculate-prorate-plus-full");try{const k={paket_layanan_id:a,metode_pembayaran:n,pelanggan_id:i,...n!=="Otomatis"&&{tgl_mulai:g}},w=await b.post(p,k);n==="Prorate"&&v?(r.value.harga_awal=w.data.harga_total_awal,aa.value=w.data.harga_prorate||0,pa.value=w.data.harga_normal||0):r.value.harga_awal=w.data.harga_awal,r.value.tgl_jatuh_tempo=w.data.tgl_jatuh_tempo}catch(k){console.error(`Error memanggil API ${p}:`,k),r.value.harga_awal=0}},{deep:!0});async function P(n=!1){n?Q.value=!0:(W.value=!0,sa.value=1,ia.value=!0);try{const a=new URLSearchParams;if(B.value&&a.append("search",B.value),N.value&&a.append("alamat",N.value),A.value&&a.append("paket_layanan_id",String(A.value)),$.value&&a.append("status",$.value),ka.value){const v=(sa.value-1)*ba;a.append("skip",String(v)),a.append("limit",String(ba))}const g=(await b.get(`/langganan/?${a.toString()}`)).data;n?f.value.push(...g):f.value=g,g.length<ba&&(ia.value=!1)}catch(a){console.error("Gagal mengambil data langganan:",a)}finally{W.value=!1,Q.value=!1}}function Ha(){Q.value||(sa.value++,P(!0))}const Ra=be(()=>{P()},500);fa([B,N,A,$],()=>{Ra()});async function Oa(){const n=[...h.value];if(n.length!==0){U.value=!0;try{const a=n.map(i=>b.delete(`/langganan/${i.id}`));await Promise.all(a),P(),h.value=[]}catch(a){console.error("Gagal melakukan hapus massal langganan:",a)}finally{U.value=!1,H.value=!1}}}const Ga=C(()=>{if(!f.value||f.value.length===0)return[];const n=f.value.map(a=>a.pelanggan.alamat);return[...new Set(n)].sort()});function Ja(){B.value="",N.value="",A.value=null,$.value=null}const Ka=C(()=>{if(Ea.value)return F.value;const n=new Set(f.value.map(i=>i.pelanggan_id));return F.value.filter(i=>!n.has(i.id))});async function Pa(){try{const n=await b.get("/pelanggan/");F.value=n.data}catch(n){console.error("Gagal mengambil data pelanggan untuk select:",n)}}async function Ya(){ra.value=!0;try{const n=await b.get("/paket_layanan/");q.value=n.data}catch(n){console.error("Gagal mengambil data paket layanan untuk select:",n),q.value=[]}finally{ra.value=!1}}function O(n){y.value=n?f.value.findIndex(a=>a.id===n.id):-1,r.value=n?{...n}:{...ga},M.value=!0}function La(){M.value=!1,Y.value=null,setTimeout(()=>{r.value={...ga},y.value=-1},300)}async function Qa(){if(!ha.value)return;ua.value=!0;const n={pelanggan_id:r.value.pelanggan_id,paket_layanan_id:r.value.paket_layanan_id,status:r.value.status,metode_pembayaran:r.value.metode_pembayaran,tgl_mulai_langganan:r.value.tgl_mulai_langganan,sertakan_bulan_depan:D.value};try{if(y.value>-1){const a={paket_layanan_id:r.value.paket_layanan_id,status:r.value.status,metode_pembayaran:r.value.metode_pembayaran,tgl_jatuh_tempo:r.value.tgl_jatuh_tempo,harga_awal:r.value.harga_awal};await b.patch(`/langganan/${r.value.id}`,a)}else await b.post("/langganan/",n);P(),La()}catch(a){console.error("Gagal menyimpan data langganan:",a)}finally{ua.value=!1}}function Da(n){R.value=n,X.value=!0}function za(){X.value=!1,R.value=null}async function Wa(){if(R.value){U.value=!0;try{await b.delete(`/langganan/${R.value.id}`),P(),za()}catch(n){console.error("Gagal menghapus langganan:",n)}finally{U.value=!1}}}function Xa(n){return f.value.some(a=>a.pelanggan_id===n)}function va(n){return n?F.value.find(i=>i.id===n)?.nama||`ID ${n}`:"N/A"}function Ca(n){return n?q.value.find(i=>i.id===n)?.nama_paket||`ID Paket ${n}`:"N/A"}function Sa(n){switch(n.toLowerCase()){case"aktif":return"green";case"non-aktif":return"orange";case"berhenti":return"red";default:return"grey"}}function j(n){return n==null?"N/A":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n)}function Ta(n){if(!n)return"N/A";const a=new Date(n);return isNaN(a.getTime())?"Invalid Date":a.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})}async function Za(){try{const n=await b.get("/langganan/export/csv",{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([n.data])),i=document.createElement("a");i.href=a,i.setAttribute("download",`export_langganan_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(i),i.click(),i.remove()}catch(n){console.error("Gagal mengekspor data langganan:",n)}}async function ae(){const n=L.value[0];if(!n)return;ma.value=!0,V.value=[];const a=new FormData;a.append("file",n);try{const i=await b.post("/langganan/import/csv",a);console.log(i.data.message),P(),xa()}catch(i){const g=i.response?.data?.detail;g&&g.errors?V.value=g.errors:V.value=[g||"Terjadi kesalahan."]}finally{ma.value=!1}}return(n,a)=>{const i=m("v-icon"),g=m("v-avatar"),v=m("v-spacer"),p=m("v-btn"),k=m("v-card-title"),w=m("v-alert"),ee=m("v-file-input"),_a=m("v-card-text"),ta=m("v-card-actions"),z=m("v-card"),la=m("v-dialog"),G=m("v-text-field"),I=m("v-select"),J=m("v-chip"),te=m("v-expand-transition"),le=m("v-progress-circular"),ne=m("v-checkbox"),Ua=m("v-divider"),na=m("v-list-item-title"),oa=m("v-list-item"),oe=m("v-list"),se=m("v-data-table"),ie=m("v-autocomplete"),re=m("v-list-item-subtitle"),E=m("v-col"),ca=m("v-row"),de=m("v-switch"),ue=m("v-form"),me=m("v-container");return _(),K(me,{fluid:"",class:"pa-sm-6 pa-4"},{default:t(()=>[s("div",ke,[s("div",we,[e(g,{class:"me-3",color:"primary",size:"40"},{default:t(()=>[e(i,{color:"white"},{default:t(()=>a[24]||(a[24]=[o("mdi-wifi-star")])),_:1,__:[24]})]),_:1}),a[25]||(a[25]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold text-primary"},"Manajemen Langganan"),s("p",{class:"text-subtitle-1 text-medium-emphasis mb-0"},"Kelola semua langganan pelanggan")],-1))]),e(v,{class:"d-none d-md-block"}),s("div",xe,[e(p,{class:"import-btn",onClick:a[0]||(a[0]=l=>Z.value=!0),"prepend-icon":"mdi-file-upload-outline",size:"default"},{default:t(()=>a[26]||(a[26]=[o(" Import ")])),_:1,__:[26]}),e(p,{class:"export-btn",onClick:Za,"prepend-icon":"mdi-file-download-outline",size:"default"},{default:t(()=>a[27]||(a[27]=[o(" Export ")])),_:1,__:[27]}),e(p,{class:"add-subscription-btn",size:"default",onClick:a[1]||(a[1]=l=>O()),"prepend-icon":"mdi-plus-circle"},{default:t(()=>a[28]||(a[28]=[o(" Tambah Langganan ")])),_:1,__:[28]})])]),e(la,{modelValue:Z.value,"onUpdate:modelValue":a[3]||(a[3]=l=>Z.value=l),"max-width":"600px",persistent:""},{default:t(()=>[e(z,{class:"import-dialog"},{default:t(()=>[e(k,{class:"import-dialog-header"},{default:t(()=>a[29]||(a[29]=[o("Import Langganan")])),_:1,__:[29]}),e(_a,{class:"import-dialog-content"},{default:t(()=>[e(w,{type:"info",variant:"tonal",class:"import-info-alert"},{default:t(()=>[a[30]||(a[30]=o(" Gunakan ")),a[31]||(a[31]=s("strong",null,"Email Pelanggan",-1)),a[32]||(a[32]=o(" dan ")),a[33]||(a[33]=s("strong",null,"Nama Paket Layanan",-1)),a[34]||(a[34]=o(" sebagai kunci pencocokan. ")),s("a",{href:`${fe(b).defaults.baseURL}/langganan/template/csv`,download:""},"Unduh template di sini",8,he),a[35]||(a[35]=o(". "))]),_:1,__:[30,31,32,33,34,35]}),V.value.length?(_(),K(w,{key:0,type:"error",closable:"","onUpdate:modelValue":a[2]||(a[2]=l=>V.value=[]),class:"import-error-alert"},{default:t(()=>[s("ul",null,[(_(!0),x(ya,null,Ba(V.value,(l,c)=>(_(),x("li",{key:c},u(l),1))),128))])]),_:1})):S("",!0),e(ee,{"model-value":L.value,"onUpdate:modelValue":ja,label:"Pilih file CSV",accept:".csv",variant:"outlined",class:"import-file-input"},null,8,["model-value"])]),_:1}),e(ta,{class:"import-dialog-actions"},{default:t(()=>[e(v),e(p,{class:"import-cancel-btn",onClick:xa},{default:t(()=>a[36]||(a[36]=[o("Batal")])),_:1,__:[36]}),e(p,{class:"import-upload-btn",onClick:ae,loading:ma.value,disabled:!L.value.length},{default:t(()=>a[37]||(a[37]=[o(" Unggah ")])),_:1,__:[37]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(z,{class:"filter-card mb-6",elevation:"0"},{default:t(()=>[s("div",Ve,[e(G,{modelValue:B.value,"onUpdate:modelValue":a[4]||(a[4]=l=>B.value=l),label:"Cari Nama Pelanggan","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:Aa.value,"hide-details":"",clearable:"",class:"flex-grow-1",style:{"min-width":"250px"}},null,8,["modelValue","density"]),e(I,{modelValue:N.value,"onUpdate:modelValue":a[5]||(a[5]=l=>N.value=l),items:Ga.value,label:"Filter Alamat","prepend-inner-icon":"mdi-map-marker",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"flex-grow-1",style:{"min-width":"200px"}},null,8,["modelValue","items"]),e(I,{modelValue:A.value,"onUpdate:modelValue":a[6]||(a[6]=l=>A.value=l),items:q.value,"item-title":"nama_paket","item-value":"id",label:"Filter Paket Layanan","prepend-inner-icon":"mdi-wifi-star",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"flex-grow-1",style:{"min-width":"200px"}},null,8,["modelValue","items"]),e(I,{modelValue:$.value,"onUpdate:modelValue":a[7]||(a[7]=l=>$.value=l),items:$a.value,label:"Filter Status","prepend-inner-icon":"mdi-list-status",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"flex-grow-1",style:{"min-width":"180px"}},null,8,["modelValue","items"]),e(p,{variant:"text",onClick:Ja,class:"text-none"},{default:t(()=>[e(i,{start:""},{default:t(()=>a[38]||(a[38]=[o("mdi-refresh")])),_:1,__:[38]}),a[39]||(a[39]=o(" Reset "))]),_:1,__:[39]})])]),_:1}),e(z,{elevation:"3",class:"rounded-lg"},{default:t(()=>[e(k,{class:"d-flex align-center pa-4 pa-sm-6 bg-grey-lighten-5"},{default:t(()=>[e(i,{start:"",icon:"mdi-format-list-bulleted-square",color:"primary"}),a[40]||(a[40]=s("span",{class:"text-h6 font-weight-bold"},"Daftar Langganan",-1)),e(v),e(J,{color:"primary",variant:"outlined",size:"small"},{default:t(()=>[o(u(f.value.length)+" langganan ",1)]),_:1})]),_:1,__:[40]}),e(te,null,{default:t(()=>[h.value.length>0?(_(),x("div",Pe,[s("span",Le,u(h.value.length)+" langganan terpilih",1),e(v),e(p,{color:"error",variant:"tonal","prepend-icon":"mdi-delete-sweep",onClick:a[8]||(a[8]=l=>H.value=!0)},{default:t(()=>a[41]||(a[41]=[o(" Hapus Terpilih ")])),_:1,__:[41]})])):S("",!0)]),_:1}),s("div",De,[W.value?(_(),x("div",ze,[e(le,{color:"primary",indeterminate:"",size:"48"}),a[42]||(a[42]=s("p",{class:"mt-4 text-medium-emphasis"},"Memuat data langganan...",-1))])):f.value.length===0?(_(),x("div",Ce,[e(i,{size:"64",color:"grey-lighten-1"},{default:t(()=>a[43]||(a[43]=[o("mdi-wifi-off")])),_:1,__:[43]}),a[45]||(a[45]=s("p",{class:"mt-4 text-h6 text-medium-emphasis"},"Belum ada data langganan",-1)),e(p,{color:"primary",variant:"elevated",onClick:a[9]||(a[9]=l=>O()),class:"mt-6 text-none","prepend-icon":"mdi-plus-circle"},{default:t(()=>a[44]||(a[44]=[o(" Tambah Langganan ")])),_:1,__:[44]})])):(_(),x("div",Se,[(_(!0),x(ya,null,Ba(f.value,l=>(_(),K(z,{key:l.id,class:"mb-3",elevation:"2",rounded:"lg"},{default:t(()=>[e(_a,{class:"pa-4"},{default:t(()=>[s("div",Te,[e(ne,{modelValue:h.value,"onUpdate:modelValue":a[10]||(a[10]=c=>h.value=c),value:l,"hide-details":"",class:"me-2 pa-0",density:"compact"},null,8,["modelValue","value"]),s("div",Ue,[s("h3",Be,u(va(l.pelanggan_id)),1),s("p",Ne,u(Ca(l.paket_layanan_id)),1)]),e(J,{size:"small",color:Sa(l.status),class:"font-weight-bold",label:""},{default:t(()=>[o(u(l.status),1)]),_:2},1032,["color"])]),e(Ua,{class:"mb-3"}),e(oe,{density:"compact",class:"bg-transparent"},{default:t(()=>[e(oa,{class:"px-0"},{prepend:t(()=>[e(i,{size:"18",class:"me-3 text-medium-emphasis"},{default:t(()=>a[46]||(a[46]=[o("mdi-cash")])),_:1,__:[46]})]),append:t(()=>[s("span",Ae,u(j(l.harga_final)),1)]),default:t(()=>[e(na,{class:"text-body-2"},{default:t(()=>a[47]||(a[47]=[o("Harga")])),_:1,__:[47]})]),_:2},1024),e(oa,{class:"px-0"},{prepend:t(()=>[e(i,{size:"18",class:"me-3 text-medium-emphasis"},{default:t(()=>a[48]||(a[48]=[o("mdi-calendar-alert")])),_:1,__:[48]})]),append:t(()=>[s("span",$e,u(Ta(l.tgl_jatuh_tempo)),1)]),default:t(()=>[e(na,{class:"text-body-2"},{default:t(()=>a[49]||(a[49]=[o("Jatuh Tempo")])),_:1,__:[49]})]),_:2},1024)]),_:2},1024),e(Ua,{class:"mt-2"}),s("div",je,[e(p,{size:"small",variant:"tonal",color:"primary",onClick:c=>O(l),class:"flex-grow-1"},{default:t(()=>[e(i,{start:"",size:"16"},{default:t(()=>a[50]||(a[50]=[o("mdi-pencil")])),_:1,__:[50]}),a[51]||(a[51]=o(" Edit "))]),_:2,__:[51]},1032,["onClick"]),e(p,{size:"small",variant:"tonal",color:"error",onClick:c=>Da(l),class:"flex-grow-1"},{default:t(()=>[e(i,{start:"",size:"16"},{default:t(()=>a[52]||(a[52]=[o("mdi-delete")])),_:1,__:[52]}),a[53]||(a[53]=o(" Hapus "))]),_:2,__:[53]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128)),ia.value&&f.value.length>0?(_(),x("div",Ie,[e(p,{variant:"tonal",color:"primary",onClick:Ha,loading:Q.value,class:"text-none"},{default:t(()=>a[54]||(a[54]=[o(" Muat Lebih Banyak ")])),_:1,__:[54]},8,["loading"])])):S("",!0)]))]),s("div",Ee,[e(se,{modelValue:h.value,"onUpdate:modelValue":a[11]||(a[11]=l=>h.value=l),headers:Fa,items:f.value,loading:W.value,"item-value":"id",class:"elevation-0","items-per-page":10,"show-select":"","return-object":""},{"item.nomor":t(({index:l})=>[o(u(l+1),1)]),"item.pelanggan_id":t(({item:l})=>[s("div",Fe,u(va(l.pelanggan_id)),1),s("div",qe,"ID: "+u(l.pelanggan_id),1)]),"item.pelanggan.alamat":t(({item:l})=>[s("div",Me,u(l.pelanggan.alamat),1)]),"item.paket_layanan_id":t(({item:l})=>[s("div",He,u(Ca(l.paket_layanan_id)),1)]),"item.metode_pembayaran":t(({item:l})=>[e(J,{size:"small",variant:"tonal",color:l.metode_pembayaran==="Prorate"?"blue":"grey-darken-1"},{default:t(()=>[o(u(l.metode_pembayaran),1)]),_:2},1032,["color"])]),"item.harga_awal":t(({item:l})=>[s("div",Re,u(j(l.harga_awal)),1)]),"item.harga_final":t(({item:l})=>[s("div",Oe,u(j(l.harga_final)),1)]),"item.status":t(({item:l})=>[e(J,{size:"small",color:Sa(l.status),class:"font-weight-bold"},{default:t(()=>[o(u(l.status),1)]),_:2},1032,["color"])]),"item.tgl_jatuh_tempo":t(({item:l})=>[o(u(Ta(l.tgl_jatuh_tempo)),1)]),"item.actions":t(({item:l})=>[s("div",Ge,[e(p,{size:"small",variant:"tonal",color:"primary",onClick:c=>O(l)},{default:t(()=>[e(i,{start:"",size:"16"},{default:t(()=>a[55]||(a[55]=[o("mdi-pencil")])),_:1,__:[55]}),a[56]||(a[56]=o(" Edit "))]),_:2,__:[56]},1032,["onClick"]),e(p,{size:"small",variant:"tonal",color:"error",onClick:c=>Da(l)},{default:t(()=>[e(i,{start:"",size:"16"},{default:t(()=>a[57]||(a[57]=[o("mdi-delete")])),_:1,__:[57]}),a[58]||(a[58]=o(" Hapus "))]),_:2,__:[58]},1032,["onClick"])])]),_:1},8,["modelValue","items","loading"])])]),_:1}),e(la,{modelValue:M.value,"onUpdate:modelValue":a[20]||(a[20]=l=>M.value=l),"max-width":"800px",persistent:"",scrollable:""},{default:t(()=>[e(z,{class:"subscription-modal"},{default:t(()=>[e(k,{class:"modal-header"},{default:t(()=>[s("div",Je,[e(i,{color:"white",size:"24",class:"me-3"},{default:t(()=>[o(u(y.value===-1?"mdi-plus-circle":"mdi-pencil"),1)]),_:1}),s("div",null,[s("h3",Ke,u(qa.value),1),s("p",Ye,u(y.value===-1?"Tambahkan langganan baru untuk pelanggan":"Perbarui informasi langganan"),1)])])]),_:1}),e(_a,{class:"modal-content"},{default:t(()=>[e(ue,{ref:"formRef",modelValue:wa.value,"onUpdate:modelValue":a[19]||(a[19]=l=>wa.value=l),"lazy-validation":""},{default:t(()=>[s("div",Qe,[s("h4",We,[e(i,{size:"18",class:"me-2"},{default:t(()=>a[59]||(a[59]=[o("mdi-account")])),_:1,__:[59]}),a[60]||(a[60]=o(" Informasi Pelanggan "))]),a[63]||(a[63]=s("label",{class:"input-label"},[o(" Pilih Pelanggan "),s("span",{class:"required-flag text-error"},"*")],-1)),e(ie,{modelValue:r.value.pelanggan_id,"onUpdate:modelValue":a[12]||(a[12]=l=>r.value.pelanggan_id=l),items:Ma.value,"item-title":"nama","item-value":"id",placeholder:"Ketik nama pelanggan untuk mencari...",variant:"outlined","prepend-inner-icon":"mdi-account-search",rules:[ea.required],disabled:y.value!==-1,density:"comfortable",clearable:"","hide-details":"auto",class:"mb-4"},{item:t(({props:l,item:c})=>[e(oa,Na(l,{class:"px-4"}),{prepend:t(()=>[e(g,{color:"primary",size:"32"},{default:t(()=>[e(i,{color:"white",size:"16"},{default:t(()=>a[61]||(a[61]=[o("mdi-account")])),_:1,__:[61]})]),_:1})]),default:t(()=>[e(na,{class:"font-weight-medium"},{default:t(()=>[o(u(c.raw.nama)+" ",1),Xa(c.raw.id)?S("",!0):(_(),K(J,{key:0,size:"x-small",color:"success",variant:"elevated",class:"ms-2"},{default:t(()=>a[62]||(a[62]=[o(" NEW USER ")])),_:1,__:[62]}))]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules","disabled"])]),s("div",Xe,[s("h4",Ze,[e(i,{size:"18",class:"me-2"},{default:t(()=>a[64]||(a[64]=[o("mdi-wifi")])),_:1,__:[64]}),a[65]||(a[65]=o(" Paket & Pembayaran "))]),e(ca,null,{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>[a[67]||(a[67]=s("label",{class:"input-label"},[o(" Pilih Paket Layanan "),s("span",{class:"required-flag text-error"},"*")],-1)),e(I,{modelValue:r.value.paket_layanan_id,"onUpdate:modelValue":a[13]||(a[13]=l=>r.value.paket_layanan_id=l),items:T.value,loading:ra.value,"item-title":"nama_paket","item-value":"id",disabled:!r.value.pelanggan_id||da.value,placeholder:"Pilih pelanggan terlebih dahulu",variant:"outlined","prepend-inner-icon":"mdi-wifi-star",rules:[ea.required],density:"comfortable","hide-details":"auto"},{item:t(({props:l,item:c})=>[e(oa,Na(l,{class:"px-4"}),{prepend:t(()=>[e(g,{color:"indigo",size:"32"},{default:t(()=>[e(i,{color:"white",size:"16"},{default:t(()=>a[66]||(a[66]=[o("mdi-wifi")])),_:1,__:[66]})]),_:1})]),default:t(()=>[e(na,{class:"font-weight-medium"},{default:t(()=>[o(u(c.raw.nama_paket),1)]),_:2},1024),e(re,null,{default:t(()=>[o(u(c.raw.kecepatan)+" Mbps - "+u(j(c.raw.harga)),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","loading","disabled","rules"])]),_:1,__:[67]}),e(E,{cols:"12",md:"6"},{default:t(()=>[a[68]||(a[68]=s("label",{class:"input-label"},[o(" Metode Pembayaran "),s("span",{class:"required-flag text-error"},"*")],-1)),e(I,{modelValue:r.value.metode_pembayaran,"onUpdate:modelValue":a[14]||(a[14]=l=>r.value.metode_pembayaran=l),items:[{title:"Otomatis (Bulanan)",value:"Otomatis"},{title:"Prorate (Proporsional)",value:"Prorate"}],variant:"outlined","prepend-inner-icon":"mdi-cash-multiple",density:"comfortable","hide-details":"auto"},null,8,["modelValue"])]),_:1,__:[68]})]),_:1}),r.value.metode_pembayaran==="Otomatis"?(_(),x("div",at,[e(G,{"model-value":r.value.harga_awal,label:"Total Harga Bulanan",variant:"outlined","prepend-inner-icon":"mdi-currency-usd",prefix:"Rp",readonly:"",density:"comfortable",class:"price-field"},null,8,["model-value"])])):S("",!0),r.value.metode_pembayaran==="Prorate"?(_(),x(ya,{key:1},[e(ca,{class:"mt-2"},{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>[e(G,{modelValue:r.value.tgl_mulai_langganan,"onUpdate:modelValue":a[15]||(a[15]=l=>r.value.tgl_mulai_langganan=l),label:"Tanggal Mulai Langganan",type:"date",variant:"outlined","prepend-inner-icon":"mdi-calendar-start",density:"comfortable","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6",class:"d-flex align-center"},{default:t(()=>[e(de,{modelValue:D.value,"onUpdate:modelValue":a[16]||(a[16]=l=>D.value=l),color:"primary",label:"Sertakan tagihan penuh bulan depan",inset:"","hide-details":"",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1}),s("div",et,[D.value&&aa.value>0?(_(),K(w,{key:0,variant:"tonal",color:"info",icon:"mdi-information-outline",density:"compact",class:"mb-4"},{default:t(()=>[s("div",tt,[a[70]||(a[70]=s("strong",null,"Rincian Tagihan Pertama:",-1)),s("div",lt,[o(" • Biaya Prorate: "+u(j(aa.value)),1),a[69]||(a[69]=s("br",null,null,-1)),o(" • Biaya Bulan Depan: "+u(j(pa.value)),1)])])]),_:1})):S("",!0),e(G,{"model-value":r.value.harga_awal,label:D.value?"Total Tagihan Pertama":"Total Harga Prorate",variant:"outlined","prepend-inner-icon":"mdi-currency-usd-circle",prefix:"Rp",readonly:"",density:"comfortable",class:"price-field"},null,8,["model-value","label"])])],64)):S("",!0)]),s("div",nt,[s("h4",ot,[e(i,{size:"18",class:"me-2"},{default:t(()=>a[71]||(a[71]=[o("mdi-cog")])),_:1,__:[71]}),a[72]||(a[72]=o(" Status & Jadwal "))]),e(ca,null,{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>[a[73]||(a[73]=s("label",{class:"input-label"},[o(" Status Langganan "),s("span",{class:"required-flag text-error"},"*")],-1)),e(I,{modelValue:r.value.status,"onUpdate:modelValue":a[17]||(a[17]=l=>r.value.status=l),items:[{title:"Aktif",value:"Aktif"},{title:"Suspended",value:"Suspended"},{title:"Berhenti",value:"Berhenti"}],variant:"outlined","prepend-inner-icon":"mdi-check-circle-outline",rules:[ea.required],density:"comfortable","hide-details":"auto"},null,8,["modelValue","rules"])]),_:1,__:[73]}),e(E,{cols:"12",md:"6"},{default:t(()=>[a[74]||(a[74]=s("label",{class:"input-label"},[o(" Tanggal Jatuh Tempo "),s("span",{class:"required-flag text-error"},"*")],-1)),e(G,{modelValue:r.value.tgl_jatuh_tempo,"onUpdate:modelValue":a[18]||(a[18]=l=>r.value.tgl_jatuh_tempo=l),type:"date",variant:"outlined","prepend-inner-icon":"mdi-calendar-alert",rules:[ea.required],density:"comfortable","hide-details":"auto"},null,8,["modelValue","rules"])]),_:1,__:[74]})]),_:1})])]),_:1},8,["modelValue"])]),_:1}),e(ta,{class:"modal-actions"},{default:t(()=>[e(v),e(p,{variant:"text",color:"grey-darken-1",onClick:La,class:"text-none"},{default:t(()=>a[75]||(a[75]=[o(" Batal ")])),_:1,__:[75]}),e(p,{color:"primary",variant:"flat",onClick:Qa,loading:ua.value,disabled:!ha.value,class:"text-none"},{default:t(()=>[e(i,{start:"",size:"18"},{default:t(()=>[o(u(y.value===-1?"mdi-plus":"mdi-content-save"),1)]),_:1}),o(" "+u(y.value===-1?"Tambah Langganan":"Simpan Perubahan"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(la,{modelValue:X.value,"onUpdate:modelValue":a[21]||(a[21]=l=>X.value=l),"max-width":"500px"},{default:t(()=>[e(z,{class:"rounded-xl elevation-8"},{default:t(()=>[s("div",st,[e(g,{size:"64",color:"error",class:"mb-4"},{default:t(()=>[e(i,{size:"32",color:"white"},{default:t(()=>a[76]||(a[76]=[o("mdi-delete-alert")])),_:1,__:[76]})]),_:1}),a[81]||(a[81]=s("h2",{class:"text-h5 font-weight-bold text-error mb-2"},"Konfirmasi Hapus",-1)),s("p",it,[a[77]||(a[77]=o(" Apakah Anda yakin ingin menghapus langganan untuk pelanggan ")),s("strong",rt,u(va(R.value?.pelanggan_id)),1),a[78]||(a[78]=o("? "))]),e(w,{variant:"tonal",color:"warning",class:"mt-4 text-start"},{default:t(()=>[e(i,{start:""},{default:t(()=>a[79]||(a[79]=[o("mdi-alert-triangle")])),_:1,__:[79]}),a[80]||(a[80]=o(" Tindakan ini tidak dapat dibatalkan "))]),_:1,__:[80]})]),e(ta,{class:"pa-6 pt-0"},{default:t(()=>[e(v),e(p,{variant:"text",color:"grey-darken-1",onClick:za,class:"text-none me-2"},{default:t(()=>a[82]||(a[82]=[o(" Batal ")])),_:1,__:[82]}),e(p,{color:"error",variant:"flat",onClick:Wa,loading:U.value,class:"text-none"},{default:t(()=>[e(i,{start:""},{default:t(()=>a[83]||(a[83]=[o("mdi-delete")])),_:1,__:[83]}),a[84]||(a[84]=o(" Ya, Hapus "))]),_:1,__:[84]},8,["loading"]),e(v)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(la,{modelValue:H.value,"onUpdate:modelValue":a[23]||(a[23]=l=>H.value=l),"max-width":"500px"},{default:t(()=>[e(z,{class:"rounded-xl elevation-8"},{default:t(()=>[s("div",dt,[e(g,{size:"64",color:"error",class:"mb-4"},{default:t(()=>[e(i,{size:"32",color:"white"},{default:t(()=>a[85]||(a[85]=[o("mdi-delete-alert")])),_:1,__:[85]})]),_:1}),a[88]||(a[88]=s("h2",{class:"text-h5 font-weight-bold text-error mb-2"},"Konfirmasi Hapus Massal",-1)),s("p",ut,[a[86]||(a[86]=o(" Anda yakin ingin menghapus ")),s("strong",null,u(h.value.length)+" langganan",1),a[87]||(a[87]=o(" yang dipilih? "))])]),e(ta,{class:"pa-6 pt-0"},{default:t(()=>[e(v),e(p,{variant:"text",color:"grey-darken-1",onClick:a[22]||(a[22]=l=>H.value=!1),class:"text-none me-2"},{default:t(()=>a[89]||(a[89]=[o(" Batal ")])),_:1,__:[89]}),e(p,{color:"error",variant:"flat",onClick:Oa,loading:U.value,class:"text-none"},{default:t(()=>[e(i,{start:""},{default:t(()=>a[90]||(a[90]=[o("mdi-delete")])),_:1,__:[90]}),a[91]||(a[91]=o(" Ya, Hapus "))]),_:1,__:[91]},8,["loading"]),e(v)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),_t=ye(mt,[["__scopeId","data-v-e2e9bd10"]]);export{_t as default};
