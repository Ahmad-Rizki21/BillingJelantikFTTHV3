import{d as ae,r,c as P,o as te,a as f,b as le,w as t,e as i,f as u,g as a,h as s,y as oe,t as U,l as se,_ as ne}from"./index-DDZ3D2Zd.js";const ie={class:"d-flex align-center mb-6"},re={class:"d-flex justify-center gap-2"},de={class:"d-flex align-center"},ue={class:"font-weight-bold"},me=ae({__name:"OLTView",setup(ve){const z=r([]),$=r([]),w=r(!0),T=r(!1),V=r(!1),L=r(!1),O=r(null),k=r(!1),b=r(!1),n=r({}),g=r(null),m=r({show:!1,text:"",color:"success"}),c=P(()=>!!n.value.id),j=P(()=>c.value?"Edit OLT":"Tambah OLT Baru"),A=[{title:"Nama OLT",key:"nama_olt",sortable:!0},{title:"IP Address",key:"ip_address",sortable:!0},{title:"Tipe",key:"tipe_olt",sortable:!0},{title:"Username",key:"username",sortable:!1},{title:"Actions",key:"actions",sortable:!1,width:"380px",align:"center"}],E=["HSGQ","ZTE","Huawei","Fiberhome","Lainnya"],_={required:l=>!!l||"Field ini wajib diisi.",ip:l=>/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/.test(l)||"Format IP tidak valid."};te(()=>{C(),F()});async function C(){w.value=!0;try{const l=await f.get("/olt/");z.value=l.data}catch{v("Gagal memuat data OLT","error")}finally{w.value=!1}}async function F(){T.value=!0;try{const l=await f.get("/mikrotik_servers/");$.value=l.data}catch{v("Gagal memuat daftar Mikrotik Server","error")}finally{T.value=!1}}function S(l){n.value=l?{...l,password:""}:{tipe_olt:"HSGQ"},k.value=!0}function B(){k.value=!1,n.value={}}async function Q(){V.value=!0;const l={...n.value};c.value&&!l.password&&delete l.password;try{c.value?await f.patch(`/olt/${l.id}`,l):await f.post("/olt/",l),C(),B(),v(`OLT berhasil ${c.value?"diperbarui":"ditambahkan"}`,"success")}catch(e){const d=e.response?.data?.detail?.[0]?.msg||"Gagal menyimpan data OLT";v(d,"error")}finally{V.value=!1}}function Y(l){g.value=l,b.value=!0}function H(){b.value=!1,g.value=null}async function Z(){if(g.value){L.value=!0;try{await f.delete(`/olt/${g.value.id}`),C(),v("OLT berhasil dihapus","success")}catch{v("Gagal menghapus OLT","error")}finally{L.value=!1,H()}}}async function J(l){O.value=l.id;try{const e=await f.post(`/olt/${l.id}/test-connection`);v(e.data.message||"Koneksi berhasil!","success")}catch(e){const d=e.response?.data?.message||"Koneksi gagal, terjadi error.";v(d,"error")}finally{O.value=null}}function v(l,e){m.value.text=l,m.value.color=e,m.value.show=!0}return(l,e)=>{const d=i("v-icon"),R=i("v-avatar"),y=i("v-spacer"),p=i("v-btn"),D=i("v-card-title"),W=i("v-data-table"),M=i("v-card"),x=i("v-text-field"),q=i("v-select"),G=i("v-card-text"),I=i("v-card-actions"),X=i("v-form"),K=i("v-dialog"),h=i("v-snackbar"),ee=i("v-container");return se(),le(ee,{fluid:"",class:"pa-6"},{default:t(()=>[u("div",ie,[a(R,{class:"me-3",color:"indigo",size:"40"},{default:t(()=>[a(d,{color:"white"},{default:t(()=>e[10]||(e[10]=[s("mdi-router-network")])),_:1,__:[10]})]),_:1}),e[12]||(e[12]=u("div",null,[u("h1",{class:"text-h4 font-weight-bold"},"OLT Management"),u("p",{class:"text-subtitle-1 text-medium-emphasis mb-0"},"Kelola perangkat OLT Anda")],-1)),a(y),a(p,{color:"primary",size:"large",onClick:e[0]||(e[0]=o=>S()),"prepend-icon":"mdi-plus",class:"text-none"},{default:t(()=>e[11]||(e[11]=[s(" Tambah OLT ")])),_:1,__:[11]})]),a(M,{elevation:"2",rounded:"lg"},{default:t(()=>[a(D,{class:"d-flex align-center pa-4 bg-grey-lighten-5"},{default:t(()=>[a(d,{start:""},{default:t(()=>e[13]||(e[13]=[s("mdi-table")])),_:1,__:[13]}),e[14]||(e[14]=u("span",{class:"font-weight-bold"},"Daftar OLT",-1))]),_:1,__:[14]}),a(W,{headers:A,items:z.value,loading:w.value,"item-value":"id","loading-text":"Memuat data OLT...","no-data-text":"Belum ada data OLT"},{"item.actions":t(({item:o})=>[u("div",re,[a(p,{size:"small",variant:"tonal",color:"cyan",onClick:N=>J(o),loading:O.value===o.id,class:"text-none"},{default:t(()=>[a(d,{start:"",size:"16"},{default:t(()=>e[15]||(e[15]=[s("mdi-lan-connect")])),_:1,__:[15]}),e[16]||(e[16]=s(" Test Koneksi "))]),_:2,__:[16]},1032,["onClick","loading"]),a(p,{size:"small",variant:"tonal",color:"primary",onClick:N=>S(o),class:"text-none"},{default:t(()=>[a(d,{start:"",size:"16"},{default:t(()=>e[17]||(e[17]=[s("mdi-pencil")])),_:1,__:[17]}),e[18]||(e[18]=s(" Edit "))]),_:2,__:[18]},1032,["onClick"]),a(p,{size:"small",variant:"tonal",color:"error",onClick:N=>Y(o),class:"text-none"},{default:t(()=>[a(d,{start:"",size:"16"},{default:t(()=>e[19]||(e[19]=[s("mdi-delete")])),_:1,__:[19]}),e[20]||(e[20]=s(" Hapus "))]),_:2,__:[20]},1032,["onClick"])])]),_:1},8,["items","loading"])]),_:1}),a(K,{modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=o=>k.value=o),"max-width":"600px",persistent:""},{default:t(()=>[a(M,{rounded:"lg"},{default:t(()=>[a(X,{onSubmit:oe(Q,["prevent"])},{default:t(()=>[a(D,{class:"bg-primary"},{default:t(()=>[s(U(j.value),1)]),_:1}),a(G,{class:"py-6"},{default:t(()=>[a(x,{modelValue:n.value.nama_olt,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.nama_olt=o),label:"Nama OLT (Contoh: OLT-Pusat)",variant:"outlined",class:"mb-4",rules:[_.required]},null,8,["modelValue","rules"]),a(x,{modelValue:n.value.ip_address,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.ip_address=o),label:"IP Address",variant:"outlined",class:"mb-4",rules:[_.required,_.ip]},null,8,["modelValue","rules"]),a(q,{modelValue:n.value.mikrotik_server_id,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value.mikrotik_server_id=o),items:$.value,"item-title":"name","item-value":"id",label:"Hubungkan ke Mikrotik Server",variant:"outlined",class:"mb-4",loading:T.value,rules:[_.required],"no-data-text":"Tidak ada server Mikrotik"},null,8,["modelValue","items","loading","rules"]),a(q,{modelValue:n.value.tipe_olt,"onUpdate:modelValue":e[4]||(e[4]=o=>n.value.tipe_olt=o),items:E,label:"Tipe OLT",variant:"outlined",class:"mb-4",rules:[_.required]},null,8,["modelValue","rules"]),a(x,{modelValue:n.value.username,"onUpdate:modelValue":e[5]||(e[5]=o=>n.value.username=o),label:"Username",variant:"outlined",class:"mb-4"},null,8,["modelValue"]),a(x,{modelValue:n.value.password,"onUpdate:modelValue":e[6]||(e[6]=o=>n.value.password=o),label:"Password",type:"password",variant:"outlined",placeholder:c.value?"Kosongkan jika tidak ingin diubah":"",rules:c.value?[]:[_.required]},null,8,["modelValue","placeholder","rules"])]),_:1}),a(I,{class:"pa-4 bg-grey-lighten-5"},{default:t(()=>[a(y),a(p,{text:"",onClick:B},{default:t(()=>e[21]||(e[21]=[s("Batal")])),_:1,__:[21]}),a(p,{color:"primary",type:"submit",loading:V.value},{default:t(()=>e[22]||(e[22]=[s("Simpan")])),_:1,__:[22]},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(K,{modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=o=>b.value=o),"max-width":"500px"},{default:t(()=>[a(M,{rounded:"lg"},{default:t(()=>[a(D,{class:"text-h5 text-center pt-8"},{default:t(()=>e[23]||(e[23]=[s("Konfirmasi Hapus")])),_:1,__:[23]}),a(G,{class:"text-center"},{default:t(()=>[e[24]||(e[24]=s(" Yakin ingin menghapus OLT ")),u("strong",null,U(g.value?.nama_olt),1),e[25]||(e[25]=s("? "))]),_:1,__:[24,25]}),a(I,{class:"pa-4"},{default:t(()=>[a(y),a(p,{text:"",onClick:H},{default:t(()=>e[26]||(e[26]=[s("Batal")])),_:1,__:[26]}),a(p,{color:"error",onClick:Z,loading:L.value},{default:t(()=>e[27]||(e[27]=[s("Ya, Hapus")])),_:1,__:[27]},8,["loading"]),a(y)]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(h,{modelValue:m.value.show,"onUpdate:modelValue":e[9]||(e[9]=o=>m.value.show=o),color:m.value.color,timeout:4e3,location:"top right",variant:"elevated",rounded:"lg"},{default:t(()=>[u("div",de,[a(d,{icon:m.value.color==="success"?"mdi-check-circle":"mdi-alert-circle",class:"me-3",size:"24"},null,8,["icon"]),u("span",ue,U(m.value.text),1)])]),_:1},8,["modelValue","color"])]),_:1})}}}),ce=ne(me,[["__scopeId","data-v-4dfdea80"]]);export{ce as default};
