import{d as _e,r as m,c as O,o as pe,a as w,b as N,w as l,e as r,f as o,g as t,h as s,t as d,j as P,F as Y,k as Z,l as g,_ as fe}from"./index-DDZ3D2Zd.js";const ge={class:"d-flex align-center mb-6"},xe={class:"d-flex align-center"},be={class:"text-h5 font-weight-bold"},ye={class:"text-h5 font-weight-bold"},ke={class:"d-flex align-center"},he={class:"font-weight-bold"},we={class:"text-caption text-medium-emphasis"},ze={class:"d-flex justify-center ga-2"},Ce={class:"text-h5 font-weight-bold"},Ve={class:"text-body-2 text-white text-medium-emphasis"},Re={class:"mb-6"},Pe={class:"mb-4"},De={class:"d-flex align-center mb-4"},Be={key:0,class:"text-center py-8"},Te={key:1},Ae={class:"mb-4 pa-4 bg-grey-lighten-5 rounded"},Ge={class:"d-flex align-center"},Ie={class:"d-flex align-center mb-3"},Me={class:"text-subtitle-1 font-weight-bold text-capitalize"},Ne={class:"permission-list"},Se={class:"text-body-1 mb-4"},Ue={class:"text-error"},$e=_e({__name:"RolesView",setup(He){const b=m([]),_=m([]),u=m([]),z=m(!0),D=m(!1),B=m(!1),C=m(!1),V=m(!1),p=m(-1),f=m({id:null,name:""}),y=m(null),J=[{title:"No.",key:"row_number",sortable:!1,width:"80px",align:"center"},{title:"Role Information",key:"name",sortable:!0},{title:"Permissions",key:"permissions_count",sortable:!1,align:"center",width:"180px"},{title:"Actions",key:"actions",sortable:!1,align:"center",width:"200px"}],S=O(()=>p.value===-1?{text:"Tambah Role Baru",icon:"mdi-shield-plus"}:{text:"Edit Role",icon:"mdi-shield-edit"}),Q=O(()=>_.value.reduce((a,e)=>{const n=e.name.split("_").pop()||"lainnya";return a[n]||(a[n]=[]),a[n].push(e),a},{}));function W(a){return a.split("_")[0].replace(/([A-Z])/g," $1").trim()}function X(a){return{users:"mdi-account-group",roles:"mdi-shield-account",permissions:"mdi-key-variant",dashboard:"mdi-view-dashboard",settings:"mdi-cog",lainnya:"mdi-dots-horizontal"}[a.toLowerCase()]||"mdi-key"}function U(a,e){const n=a.filter(R=>e.includes(R.id)).length;return n===a.length?"success":n>0?"warning":"grey"}function ee(a,e){return a.filter(n=>e.includes(n.id)).length}function te(a){u.value=a?_.value.map(e=>e.id):[]}function le(){u.value=[]}pe(()=>{T(),ae()});async function T(){z.value=!0;try{const a=await w.get("/roles/");b.value=a.data}catch(a){console.error("Gagal mengambil data roles:",a)}finally{z.value=!1}}async function ae(){try{const a=await w.get("/permissions/");_.value=a.data}catch(a){console.error("Gagal mengambil data permissions:",a)}}function $(a){a?(p.value=b.value.indexOf(a),f.value={...a},u.value=a.permissions.map(e=>e.id)):(p.value=-1,f.value={id:null,name:""},u.value=[]),C.value=!0}function A(){C.value=!1,p.value=-1,f.value={id:null,name:""},u.value=[]}async function oe(){D.value=!0;const a={name:f.value.name,permission_ids:u.value};try{p.value>-1?await w.patch(`/roles/${f.value.id}`,a):await w.post("/roles/",a),T(),A()}catch(e){console.error("Gagal menyimpan role:",e)}finally{D.value=!1}}function se(a){y.value=a,V.value=!0}function H(){y.value=null,V.value=!1}async function ne(){if(y.value){B.value=!0;try{await w.delete(`/roles/${y.value.id}`),T()}catch(a){console.error("Gagal menghapus role:",a)}finally{B.value=!1,H()}}}return(a,e)=>{const n=r("v-icon"),R=r("v-avatar"),c=r("v-spacer"),v=r("v-btn"),x=r("v-card"),G=r("v-col"),E=r("v-row"),k=r("v-chip"),I=r("v-card-title"),ie=r("v-skeleton-loader"),re=r("v-data-table"),de=r("v-text-field"),ue=r("v-progress-circular"),j=r("v-checkbox"),q=r("v-container"),F=r("v-card-text"),me=r("v-divider"),K=r("v-card-actions"),L=r("v-dialog"),ce=r("v-alert");return g(),N(q,{fluid:"",class:"pa-6"},{default:l(()=>[o("div",ge,[o("div",xe,[t(R,{class:"me-3",color:"primary",size:"40"},{default:l(()=>[t(n,{color:"white"},{default:l(()=>e[5]||(e[5]=[s("mdi-shield-account")])),_:1,__:[5]})]),_:1}),e[6]||(e[6]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold text-primary"},"Role Management"),o("p",{class:"text-subtitle-1 text-medium-emphasis mb-0"},"Kelola roles dan permissions sistem")],-1))]),t(c),t(v,{color:"primary",size:"large",elevation:"2",onClick:e[0]||(e[0]=i=>$()),"prepend-icon":"mdi-plus",class:"text-none"},{default:l(()=>e[7]||(e[7]=[s(" Tambah Role ")])),_:1,__:[7]})]),t(E,{class:"mb-6"},{default:l(()=>[t(G,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(x,{class:"pa-4 text-center",elevation:"2",color:"primary",variant:"tonal"},{default:l(()=>[t(n,{size:"32",color:"primary",class:"mb-2"},{default:l(()=>e[8]||(e[8]=[s("mdi-shield-check")])),_:1,__:[8]}),o("div",be,d(b.value.length),1),e[9]||(e[9]=o("div",{class:"text-body-2 text-medium-emphasis"},"Total Roles",-1))]),_:1,__:[9]})]),_:1}),t(G,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(x,{class:"pa-4 text-center",elevation:"2",color:"success",variant:"tonal"},{default:l(()=>[t(n,{size:"32",color:"success",class:"mb-2"},{default:l(()=>e[10]||(e[10]=[s("mdi-key")])),_:1,__:[10]}),o("div",ye,d(_.value.length),1),e[11]||(e[11]=o("div",{class:"text-body-2 text-medium-emphasis"},"Total Permissions",-1))]),_:1,__:[11]})]),_:1})]),_:1}),t(x,{elevation:"3",class:"rounded-lg"},{default:l(()=>[t(I,{class:"d-flex align-center pa-6 bg-grey-lighten-5"},{default:l(()=>[t(n,{start:"",icon:"mdi-format-list-bulleted-square",color:"primary"}),e[12]||(e[12]=o("span",{class:"text-h6 font-weight-bold"},"Daftar Roles",-1)),t(c),t(k,{color:"primary",variant:"outlined",size:"small"},{default:l(()=>[s(d(b.value.length)+" roles ",1)]),_:1})]),_:1,__:[12]}),t(re,{headers:J,items:b.value,loading:z.value,"item-value":"id",class:"elevation-0","items-per-page":10,"loading-text":"Memuat data roles...","no-data-text":"Tidak ada data roles"},{loading:l(()=>[t(ie,{type:"table-row@5"})]),"item.row_number":l(({index:i})=>[t(k,{size:"small",color:"blue-grey",variant:"outlined"},{default:l(()=>[s(d(i+1),1)]),_:2},1024)]),"item.name":l(({item:i})=>[o("div",ke,[t(R,{size:"32",color:"primary",class:"me-3"},{default:l(()=>[t(n,{color:"white",size:"18"},{default:l(()=>e[13]||(e[13]=[s("mdi-shield")])),_:1,__:[13]})]),_:1}),o("div",null,[o("div",he,d(i.name),1),o("div",we,"Role ID: "+d(i.id),1)])])]),"item.permissions_count":l(({item:i})=>[t(k,{size:"small",color:i.permissions.length>5?"success":i.permissions.length>2?"warning":"error",variant:"tonal",class:"font-weight-bold"},{default:l(()=>[t(n,{start:"",size:"16"},{default:l(()=>e[14]||(e[14]=[s("mdi-key-variant")])),_:1,__:[14]}),s(" "+d(i.permissions.length)+" Permissions ",1)]),_:2},1032,["color"])]),"item.actions":l(({item:i})=>[o("div",ze,[t(v,{size:"small",variant:"tonal",color:"primary",onClick:h=>$(i),class:"text-none"},{default:l(()=>[t(n,{start:"",size:"16"},{default:l(()=>e[15]||(e[15]=[s("mdi-pencil")])),_:1,__:[15]}),e[16]||(e[16]=s(" Edit "))]),_:2,__:[16]},1032,["onClick"]),t(v,{size:"small",variant:"tonal",color:"error",onClick:h=>se(i),class:"text-none"},{default:l(()=>[t(n,{start:"",size:"16"},{default:l(()=>e[17]||(e[17]=[s("mdi-delete")])),_:1,__:[17]}),e[18]||(e[18]=s(" Hapus "))]),_:2,__:[18]},1032,["onClick"])])]),_:1},8,["items","loading"])]),_:1}),t(L,{modelValue:C.value,"onUpdate:modelValue":e[3]||(e[3]=i=>C.value=i),"max-width":"900px",persistent:"",scrollable:""},{default:l(()=>[t(x,{class:"rounded-lg"},{default:l(()=>[t(I,{class:"d-flex align-center pa-6 bg-primary text-white"},{default:l(()=>[t(n,{icon:S.value.icon,start:"",class:"me-3"},null,8,["icon"]),o("div",null,[o("div",Ce,d(S.value.text),1),o("div",Ve,d(p.value===-1?"Buat role baru dengan permissions":"Ubah informasi role dan permissions"),1)]),t(c),t(v,{icon:"",variant:"text",onClick:A,color:"white"},{default:l(()=>[t(n,null,{default:l(()=>e[19]||(e[19]=[s("mdi-close")])),_:1,__:[19]})]),_:1})]),_:1}),t(F,{class:"pa-6"},{default:l(()=>[t(q,{fluid:""},{default:l(()=>[o("div",Re,[t(de,{modelValue:f.value.name,"onUpdate:modelValue":e[1]||(e[1]=i=>f.value.name=i),label:"Nama Role",variant:"outlined",rules:[i=>!!i||"Nama role tidak boleh kosong"],required:"","prepend-inner-icon":"mdi-shield",placeholder:"Masukkan nama role",class:"mb-4","hide-details":"auto"},null,8,["modelValue","rules"])]),o("div",Pe,[o("div",De,[t(n,{color:"primary",class:"me-2"},{default:l(()=>e[20]||(e[20]=[s("mdi-key-variant")])),_:1,__:[20]}),e[21]||(e[21]=o("h3",{class:"text-h6 font-weight-bold text-primary"},"Hak Akses (Permissions)",-1)),t(c),t(k,{size:"small",color:"primary",variant:"outlined"},{default:l(()=>[s(d(u.value.length)+" dipilih ",1)]),_:1})]),!_.value.length&&z.value?(g(),P("div",Be,[t(ue,{indeterminate:"",color:"primary",size:"40"}),e[22]||(e[22]=o("p",{class:"mt-4 text-body-1"},"Memuat permissions...",-1))])):(g(),P("div",Te,[o("div",Ae,[o("div",Ge,[t(j,{"model-value":u.value.length===_.value.length,indeterminate:u.value.length>0&&u.value.length<_.value.length,"onUpdate:modelValue":te,label:"Pilih Semua Permissions",density:"compact",color:"primary","hide-details":""},null,8,["model-value","indeterminate"]),t(c),t(v,{size:"small",variant:"text",color:"error",onClick:le,class:"text-none"},{default:l(()=>[t(n,{start:"",size:"16"},{default:l(()=>e[23]||(e[23]=[s("mdi-close")])),_:1,__:[23]}),e[24]||(e[24]=s(" Clear All "))]),_:1,__:[24]})])]),t(E,null,{default:l(()=>[(g(!0),P(Y,null,Z(Q.value,(i,h)=>(g(),N(G,{key:h,cols:"12",md:"6",lg:"4"},{default:l(()=>[t(x,{class:"permission-group pa-4 h-100",variant:"outlined",color:U(i,u.value)},{default:l(()=>[o("div",Ie,[t(n,{color:U(i,u.value),class:"me-2"},{default:l(()=>[s(d(X(String(h))),1)]),_:2},1032,["color"]),o("h4",Me,d(String(h).replace("_"," ")),1),t(c),t(k,{size:"x-small",variant:"outlined"},{default:l(()=>[s(d(ee(i,u.value))+"/"+d(i.length),1)]),_:2},1024)]),o("div",Ne,[(g(!0),P(Y,null,Z(i,M=>(g(),N(j,{key:M.id,modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=ve=>u.value=ve),label:W(M.name),value:M.id,density:"compact",color:"primary","hide-details":"",class:"mb-1"},null,8,["modelValue","label","value"]))),128))])]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1})]))])]),_:1})]),_:1}),t(me),t(K,{class:"pa-6"},{default:l(()=>[t(c),t(v,{variant:"outlined",onClick:A,size:"large",class:"text-none me-3"},{default:l(()=>e[25]||(e[25]=[s(" Batal ")])),_:1,__:[25]}),t(v,{color:"primary",variant:"flat",onClick:oe,size:"large",class:"text-none",loading:D.value},{default:l(()=>[t(n,{start:""},{default:l(()=>e[26]||(e[26]=[s("mdi-content-save")])),_:1,__:[26]}),s(" "+d(p.value===-1?"Buat Role":"Simpan Perubahan"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(L,{modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=i=>V.value=i),"max-width":"500px"},{default:l(()=>[t(x,{class:"rounded-lg"},{default:l(()=>[t(I,{class:"text-h5 text-center pt-8 text-error"},{default:l(()=>[t(n,{size:"48",color:"error",class:"mb-4"},{default:l(()=>e[27]||(e[27]=[s("mdi-alert-circle")])),_:1,__:[27]}),e[28]||(e[28]=o("br",null,null,-1)),e[29]||(e[29]=s(" Konfirmasi Hapus "))]),_:1,__:[28,29]}),t(F,{class:"text-center pa-6"},{default:l(()=>[o("p",Se,[e[30]||(e[30]=s(" Anda akan menghapus role ")),o("strong",Ue,d(y.value?.name),1)]),t(ce,{type:"warning",variant:"tonal",class:"text-start"},{default:l(()=>[t(n,{start:""},{default:l(()=>e[31]||(e[31]=[s("mdi-warning")])),_:1,__:[31]}),e[32]||(e[32]=s(" Tindakan ini tidak dapat dibatalkan dan akan menghapus semua permission yang terkait. "))]),_:1,__:[32]})]),_:1}),t(K,{class:"pa-6"},{default:l(()=>[t(c),t(v,{variant:"outlined",onClick:H,size:"large",class:"text-none me-3"},{default:l(()=>e[33]||(e[33]=[s(" Batal ")])),_:1,__:[33]}),t(v,{color:"error",variant:"flat",onClick:ne,size:"large",class:"text-none",loading:B.value},{default:l(()=>[t(n,{start:""},{default:l(()=>e[34]||(e[34]=[s("mdi-delete")])),_:1,__:[34]}),e[35]||(e[35]=s(" Ya, Hapus Role "))]),_:1,__:[35]},8,["loading"]),t(c)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),je=fe($e,[["__scopeId","data-v-a301614c"]]);export{je as default};
