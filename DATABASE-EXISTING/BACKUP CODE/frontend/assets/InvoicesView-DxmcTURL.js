import{d as Te,c as ae,b as V,e as d,w as a,i as x,g as t,f as n,h as o,t as u,j as T,l as _,_ as Pe,z as lt,r as p,o as it,q as ot,a as S,p as st,s as X,m as $,v as Le,F as dt,k as rt}from"./index-DDZ3D2Zd.js";import{d as ut}from"./debounce-BMmXVQ06.js";const ct={class:"header-section pa-6 position-relative overflow-hidden rounded-t-xl"},vt={class:"d-flex align-center position-relative"},mt={class:"header-icon-wrapper me-4"},pt={class:"flex-grow-1"},_t={class:"text-subtitle-1 mb-0 header-subtitle"},ft={class:"content-section pa-6"},gt={class:"info-card"},yt={class:"card-header"},bt={class:"card-icon-wrapper"},xt={class:"card-content"},wt={class:"info-row"},kt={class:"info-value"},ht={class:"info-row"},Dt={class:"info-value"},$t={class:"info-row highlight-row"},Vt={class:"info-value total-amount"},Ct={key:0,class:"info-row paid-row"},It={class:"info-value paid-value"},Lt={class:"info-card"},Tt={class:"card-header"},Pt={class:"card-icon-wrapper secondary"},zt={class:"card-content"},Ut={class:"info-row"},Bt={class:"info-value"},Nt={class:"info-row"},St={class:"info-value"},Kt={class:"info-row"},At={class:"info-value"},Mt={class:"payment-section"},Ft={class:"card-header mb-4"},jt={class:"card-icon-wrapper info"},Et={class:"payment-link-wrapper"},Ht=Te({__name:"InvoiceDetailDialog",props:{modelValue:{type:Boolean},invoice:{}},emits:["update:modelValue"],setup(ce){const C=ce,h=ae(()=>{switch(C.invoice?.status_invoice){case"Lunas":return"success";case"Belum Dibayar":return"warning";case"Kadaluarsa":return"error";default:return"grey"}});function K(c){return c?new Date(c).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):"N/A"}function G(c){return c?new Date(c).toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}function A(c){return c==null?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(c)}async function J(){if(C.invoice?.payment_link)try{await navigator.clipboard.writeText(C.invoice.payment_link),alert("Link pembayaran disalin!")}catch{alert("Gagal menyalin link.")}}return(c,s)=>{const f=d("v-icon"),W=d("v-chip"),Z=d("v-card-title"),b=d("v-col"),M=d("v-row"),I=d("v-btn"),P=d("v-text-field"),w=d("v-card-text"),z=d("v-spacer"),F=d("v-card-actions"),O=d("v-card"),U=d("v-dialog");return _(),V(U,{"model-value":c.modelValue,"onUpdate:modelValue":s[1]||(s[1]=B=>c.$emit("update:modelValue",B)),"max-width":"900px",scrim:!1,class:"invoice-dialog"},{default:a(()=>[c.invoice?(_(),V(O,{key:0,class:"invoice-detail-dialog elevation-0",rounded:"xl"},{default:a(()=>[t(Z,{class:"pa-0"},{default:a(()=>[n("div",ct,[s[4]||(s[4]=n("div",{class:"header-pattern"},null,-1)),n("div",vt,[n("div",mt,[t(f,{size:"28",class:"header-icon"},{default:a(()=>s[2]||(s[2]=[o("mdi-receipt-text-check-outline")])),_:1,__:[2]})]),n("div",pt,[s[3]||(s[3]=n("h2",{class:"text-h5 font-weight-bold mb-1 header-title"},"Detail Invoice",-1)),n("p",_t,u(c.invoice.invoice_number),1)]),t(W,{color:h.value,size:"large",variant:"elevated",class:"font-weight-bold status-chip","prepend-icon":"mdi-check-circle"},{default:a(()=>[o(u(c.invoice.status_invoice),1)]),_:1},8,["color"])])])]),_:1}),t(w,{class:"pa-0"},{default:a(()=>[n("div",ft,[t(M,{class:"mb-6"},{default:a(()=>[t(b,{cols:"12",md:"6"},{default:a(()=>[n("div",gt,[n("div",yt,[n("div",bt,[t(f,{size:"20",class:"card-icon"},{default:a(()=>s[5]||(s[5]=[o("mdi-file-document-outline")])),_:1,__:[5]})]),s[6]||(s[6]=n("h3",{class:"card-title"},"Informasi Tagihan",-1))]),n("div",xt,[n("div",wt,[s[7]||(s[7]=n("span",{class:"info-label"},"Tanggal Invoice",-1)),n("span",kt,u(K(c.invoice.tgl_invoice)),1)]),n("div",ht,[s[8]||(s[8]=n("span",{class:"info-label"},"Jatuh Tempo",-1)),n("span",Dt,u(K(c.invoice.tgl_jatuh_tempo)),1)]),n("div",$t,[s[9]||(s[9]=n("span",{class:"info-label"},"Total Tagihan",-1)),n("span",Vt,u(A(c.invoice.total_harga)),1)]),c.invoice.paid_at?(_(),T("div",Ct,[s[10]||(s[10]=n("span",{class:"info-label"},"Tanggal Lunas",-1)),n("span",It,u(G(c.invoice.paid_at)),1)])):x("",!0)])])]),_:1}),t(b,{cols:"12",md:"6"},{default:a(()=>[n("div",Lt,[n("div",Tt,[n("div",Pt,[t(f,{size:"20",class:"card-icon"},{default:a(()=>s[11]||(s[11]=[o("mdi-account-circle-outline")])),_:1,__:[11]})]),s[12]||(s[12]=n("h3",{class:"card-title"},"Informasi Pelanggan",-1))]),n("div",zt,[n("div",Ut,[s[13]||(s[13]=n("span",{class:"info-label"},"ID PPPoE / ID Pelanggan",-1)),n("span",Bt,u(c.invoice.id_pelanggan),1)]),n("div",Nt,[s[14]||(s[14]=n("span",{class:"info-label"},"Email",-1)),n("span",St,u(c.invoice.email),1)]),n("div",Kt,[s[15]||(s[15]=n("span",{class:"info-label"},"No. Telepon",-1)),n("span",At,u(c.invoice.no_telp),1)])])])]),_:1})]),_:1}),n("div",Mt,[n("div",Ft,[n("div",jt,[t(f,{size:"20",class:"card-icon"},{default:a(()=>s[16]||(s[16]=[o("mdi-credit-card-outline")])),_:1,__:[16]})]),s[17]||(s[17]=n("h3",{class:"card-title"},"Informasi Pembayaran (Xendit)",-1))]),n("div",Et,[t(P,{"model-value":c.invoice.payment_link,label:"Link Pembayaran",variant:"outlined",density:"comfortable",readonly:"",class:"payment-link-field","prepend-inner-icon":"mdi-link-variant",color:"primary"},{"append-inner":a(()=>[t(I,{icon:"mdi-content-copy",size:"small",variant:"text",class:"copy-btn",onClick:J})]),_:1},8,["model-value"])])])])]),_:1}),t(F,{class:"pa-6 pt-0"},{default:a(()=>[t(z),t(I,{variant:"elevated",color:"primary",size:"large",class:"close-btn",onClick:s[0]||(s[0]=B=>c.$emit("update:modelValue",!1))},{default:a(()=>[t(f,{start:""},{default:a(()=>s[18]||(s[18]=[o("mdi-close")])),_:1,__:[18]}),s[19]||(s[19]=o(" Tutup "))]),_:1,__:[19]})]),_:1})]),_:1})):x("",!0)]),_:1},8,["model-value"])}}}),Rt=Pe(Ht,[["__scopeId","data-v-420822ca"]]),Gt={class:"invoice-header mb-8 pa-6 rounded-xl"},Jt={class:"d-flex flex-column flex-md-row align-start align-md-center gap-4"},Wt={class:"header-content d-flex align-center"},Ot={class:"icon-container me-4"},Yt={class:"d-flex align-center"},qt={class:"stats-icon success me-3"},Qt={class:"text-h6 font-weight-bold"},Xt={class:"d-flex align-center"},Zt={class:"stats-icon warning me-3"},ea={class:"text-h6 font-weight-bold"},ta={class:"d-flex align-center"},aa={class:"stats-icon error me-3"},na={class:"text-h6 font-weight-bold"},la={class:"d-flex align-center"},ia={class:"stats-icon primary me-3"},oa={class:"text-h6 font-weight-bold"},sa={class:"d-flex flex-wrap align-center gap-4 pa-4"},da={key:0,class:"selection-toolbar"},ra={class:"font-weight-bold text-primary"},ua={class:"responsive-table-container d-none d-md-block"},ca={class:"text-center pa-8"},va={class:"invoice-number-cell",style:{"min-width":"180px"}},ma={class:"font-weight-bold text-primary"},pa={class:"text-caption text-medium-emphasis"},_a={class:"customer-cell",style:{"min-width":"220px"}},fa={class:"d-flex align-center"},ga={class:"font-weight-medium"},ya={class:"text-caption text-medium-emphasis"},ba={class:"amount-cell",style:{"min-width":"150px"}},xa={class:"text-h6 font-weight-bold text-success"},wa={class:"due-date-cell",style:{"min-width":"150px"}},ka={class:"font-weight-medium"},ha={class:"action-buttons",style:{"min-width":"180px"}},Da={class:"d-md-none pa-4"},$a={key:0,class:"text-center py-8"},Va={key:1,class:"text-center py-8"},Ca={key:2},Ia={class:"d-flex align-center pa-2"},La=["onClick"],Ta={class:"font-weight-bold text-primary"},Pa={class:"text-caption text-medium-emphasis"},za={class:"font-weight-bold text-success"},Ua={class:"text-right"},Ba={class:"mb-4"},Na={key:0},Sa={class:"d-flex align-center"},Ka=Te({__name:"InvoicesView",setup(ce){const C=lt(),h=p([]),K=p([]),G=p([]),A=p(!0),J=p(!1),c=p(""),s=p(!1),f=p(null),W=p(!1),Z=p(null),b=p({show:!1,text:"",color:"success"}),M=p(!1),I=p(!1),P=p(null),w=p([]),z=p(!1),F=p(!1),O=p(!1),U=p(null),B=p("Cash"),j=p(null),E=p(null),H=p(null),ze=p(["Lunas","Belum Dibayar","Kadaluarsa"]),ne=p(!1),Ue=[{title:"Nomor Invoice",key:"invoice_number",width:"200px"},{title:"Pelanggan",key:"pelanggan_id",width:"250px"},{title:"Total Tagihan",key:"total_harga",align:"end",width:"150px"},{title:"Status",key:"status_invoice",align:"center",width:"130px"},{title:"Jatuh Tempo",key:"tgl_jatuh_tempo",align:"center",width:"150px"},{title:"Actions",key:"actions",sortable:!1,align:"center",width:"120px"}];function Be(i){return h.value.some(e=>e.pelanggan_id===i)}const Ne=ae(()=>G.value.map(i=>{const e=K.value.find(v=>v.id===i.pelanggan_id),r=e?!Be(e.id):!1,g=`${e?.nama||"N/A"}${r?" - NEW USER":""}`;return{id:i.id,title:g,raw:{...i,pelanggan:e,is_new_user:i.is_new_user||!1}}})),le=ae(()=>f.value?G.value.find(i=>i.id===f.value):null),Se=()=>h.value.filter(i=>i.status_invoice==="Lunas").length,Ke=()=>h.value.filter(i=>i.status_invoice==="Belum Dibayar").length,Ae=()=>h.value.filter(i=>i.status_invoice==="Kadaluarsa").length;function ve(i){return K.value.find(r=>r.id===i)?.nama||`ID: ${i}`}function me(i){switch(i){case"Lunas":return"success";case"Kadaluarsa":return"error";case"Belum Dibayar":return"warning";default:return"grey"}}const ie=ae(()=>ne.value?h.value:h.value.filter(i=>i.status_invoice==="Belum Dibayar"));function Me(i){switch(i){case"Lunas":return"mdi-check-circle";case"Kadaluarsa":return"mdi-alert-circle";case"Belum Dibayar":return"mdi-clock-outline";default:return"mdi-help-circle"}}function pe(i){if(i.status_invoice==="Lunas")return"";const e=new Date;e.setHours(0,0,0,0);const r=new Date(i.tgl_jatuh_tempo);r.setHours(0,0,0,0);const g=r.getTime()-e.getTime(),v=Math.ceil(g/(1e3*60*60*24));return v<0?`${Math.abs(v)} hari terlambat`:v===0?"Jatuh tempo hari ini":v===1?"Jatuh tempo besok":`${v} hari lagi`}function Y(i){return i?new Date(i).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):"N/A"}function oe(i){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(i)}it(()=>{N(),Ee(),He(),window.addEventListener("new-notification",fe)}),ot(()=>{window.removeEventListener("new-notification",fe)});async function N(){A.value=!0;try{const i=new URLSearchParams;c.value&&i.append("search",c.value),j.value&&i.append("status_invoice",j.value),E.value&&i.append("start_date",E.value),H.value&&i.append("end_date",H.value);const e=await S.get(`/invoices/?${i.toString()}`);h.value=e.data.sort((r,g)=>g.id-r.id)}finally{A.value=!1}}function _e(i){let e=i.no_telp||"";e.startsWith("0")&&(e="62"+e.substring(1)),e=e.replace(/[^0-9]/g,"");const g=`Link Pembayaran Internet dengan Link berikut: ${i.payment_link}`,v=encodeURIComponent(g),y=`https://wa.me/${e}?text=${v}`;window.open(y,"_blank")}const Fe=ut(()=>{N()});st([c,j,E,H],()=>{Fe()});function je(){c.value="",j.value=null,E.value=null,H.value=null}const fe=i=>{i.detail.type==="new_payment"&&N()};async function Ee(){try{const i=await S.get("/pelanggan/");K.value=i.data}catch(i){console.error(i)}}async function He(){try{const i=await S.get("/langganan/?for_invoice_selection=true");G.value=i.data}catch(i){console.error("Error fetching langganan:",i)}}function se(i){Z.value=i,W.value=!0}function Re(){f.value=null,s.value=!0}async function Ge(){if(f.value){J.value=!0;try{await S.post("/invoices/generate",{langganan_id:f.value}),k("Invoice berhasil dibuat!","success"),N(),ge()}catch(i){const e=i.response?.data?.detail||"Gagal membuat invoice.";k(e,"error")}finally{J.value=!1}}}function ge(){s.value=!1,f.value=null}async function ye(i){if(!i){k("Tidak ada link pembayaran","warning");return}try{await navigator.clipboard.writeText(i),k("Link pembayaran berhasil disalin!","success")}catch{k("Gagal menyalin link","error")}}function k(i,e){b.value.text=i,b.value.color=e,b.value.show=!0}function Je(i){switch(i){case"success":return"mdi-check-circle";case"error":return"mdi-alert-circle";case"warning":return"mdi-alert";default:return"mdi-information"}}function be(i){P.value=i,M.value=!0}function xe(){M.value=!1,P.value=null}async function We(){if(P.value){I.value=!0;try{await S.delete(`/invoices/${P.value.id}`),k("Invoice berhasil dihapus","success"),N(),xe()}catch(i){const e=i.response?.data?.detail||"Gagal menghapus invoice.";k(e,"error")}finally{I.value=!1}}}async function Oe(){const i=[...w.value];if(i.length!==0){I.value=!0;try{const e=i.map(r=>S.delete(`/invoices/${r.id}`));await Promise.all(e),k(`${i.length} invoice berhasil dihapus.`,"success"),N(),w.value=[]}catch{k("Terjadi kesalahan saat menghapus data.","error")}finally{I.value=!1,z.value=!1}}}function we(i){U.value=i,B.value="Cash",F.value=!0}function ke(){F.value=!1,U.value=null}async function Ye(){if(U.value){O.value=!0;try{await S.post(`/invoices/${U.value.id}/mark-as-paid`,{metode_pembayaran:B.value}),k("Invoice berhasil ditandai lunas","success"),N(),ke()}catch(i){const e=i.response?.data?.detail||"Gagal menandai lunas.";k(e,"error")}finally{O.value=!1}}}return(i,e)=>{const r=d("v-icon"),g=d("v-spacer"),v=d("v-btn"),y=d("v-card"),R=d("v-col"),he=d("v-row"),q=d("v-text-field"),De=d("v-select"),qe=d("v-switch"),$e=d("v-expand-transition"),Ve=d("v-progress-circular"),Qe=d("v-avatar"),Ce=d("v-chip"),D=d("v-tooltip"),de=d("v-card-title"),ee=d("v-card-text"),Q=d("v-card-actions"),te=d("v-dialog"),Xe=d("v-data-table"),Ze=d("v-checkbox-btn"),Ie=d("v-divider"),re=d("v-list-item-title"),ue=d("v-list-item"),et=d("v-list"),tt=d("v-autocomplete"),at=d("v-snackbar"),nt=d("v-container");return _(),V(nt,{fluid:"",class:"pa-4 pa-sm-6"},{default:a(()=>[n("div",Gt,[n("div",Jt,[n("div",Wt,[n("div",Ot,[t(r,{size:"32",color:"white"},{default:a(()=>e[18]||(e[18]=[o("mdi-receipt-text-outline")])),_:1,__:[18]})]),e[19]||(e[19]=n("div",null,[n("h1",{class:"text-h4 text-md-h3 font-weight-bold text-white mb-1"},"Invoices"),n("p",{class:"text-subtitle-1 text-white text-opacity-90 mb-0"}," Kelola tagihan dan pembayaran ")],-1))]),t(g,{class:"d-none d-md-block"}),X(C).hasPermission("create_invoices")?(_(),V(v,{key:0,color:"white",variant:"elevated",size:"large",elevation:"4",onClick:Re,"prepend-icon":"mdi-plus-circle-outline",class:"text-none font-weight-bold w-100 w-md-auto",style:{color:"#4338ca !important"}},{default:a(()=>e[20]||(e[20]=[o(" Buat Invoice Manual ")])),_:1,__:[20]})):x("",!0)])]),t(he,{class:"mb-6"},{default:a(()=>[t(R,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(y,{class:"stats-card pa-4",elevation:"2"},{default:a(()=>[n("div",Yt,[n("div",qt,[t(r,{color:"success"},{default:a(()=>e[21]||(e[21]=[o("mdi-check-circle")])),_:1,__:[21]})]),n("div",null,[n("div",Qt,u(Se()),1),e[22]||(e[22]=n("div",{class:"text-caption text-medium-emphasis"},"Invoice Lunas",-1))])])]),_:1})]),_:1}),t(R,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(y,{class:"stats-card pa-4",elevation:"2"},{default:a(()=>[n("div",Xt,[n("div",Zt,[t(r,{color:"warning"},{default:a(()=>e[23]||(e[23]=[o("mdi-clock-outline")])),_:1,__:[23]})]),n("div",null,[n("div",ea,u(Ke()),1),e[24]||(e[24]=n("div",{class:"text-caption text-medium-emphasis"},"Belum Dibayar",-1))])])]),_:1})]),_:1}),t(R,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(y,{class:"stats-card pa-4",elevation:"2"},{default:a(()=>[n("div",ta,[n("div",aa,[t(r,{color:"error"},{default:a(()=>e[25]||(e[25]=[o("mdi-alert-circle")])),_:1,__:[25]})]),n("div",null,[n("div",na,u(Ae()),1),e[26]||(e[26]=n("div",{class:"text-caption text-medium-emphasis"},"Kadaluarsa",-1))])])]),_:1})]),_:1}),t(R,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(y,{class:"stats-card pa-4",elevation:"2"},{default:a(()=>[n("div",la,[n("div",ia,[t(r,{color:"primary"},{default:a(()=>e[27]||(e[27]=[o("mdi-receipt-text")])),_:1,__:[27]})]),n("div",null,[n("div",oa,u(h.value.length),1),e[28]||(e[28]=n("div",{class:"text-caption text-medium-emphasis"},"Total Invoice",-1))])])]),_:1})]),_:1})]),_:1}),t(y,{class:"filter-card mb-6",elevation:"0"},{default:a(()=>[n("div",sa,[t(q,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),label:"Cari (No. Invoice, Nama, ID)","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable","hide-details":"",class:"flex-grow-1",style:{"min-width":"250px"}},null,8,["modelValue"]),t(De,{modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=l=>j.value=l),items:ze.value,label:"Filter Status",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"flex-grow-1",style:{"min-width":"180px"}},null,8,["modelValue","items"]),t(q,{modelValue:E.value,"onUpdate:modelValue":e[2]||(e[2]=l=>E.value=l),label:"Dari Tanggal",type:"date",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"flex-grow-1",style:{"min-width":"180px"}},null,8,["modelValue"]),t(q,{modelValue:H.value,"onUpdate:modelValue":e[3]||(e[3]=l=>H.value=l),label:"Sampai Tanggal",type:"date",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"flex-grow-1",style:{"min-width":"180px"}},null,8,["modelValue"]),t(qe,{modelValue:ne.value,"onUpdate:modelValue":e[4]||(e[4]=l=>ne.value=l),color:"success",label:"Tampilkan Lunas & Kadaluarsa","hide-details":"",density:"comfortable",class:"flex-grow-0 ms-md-4"},null,8,["modelValue"]),t(g),e[30]||(e[30]=o()),t(v,{variant:"text",onClick:je,class:"text-none"},{default:a(()=>e[29]||(e[29]=[o(" Reset Filter ")])),_:1,__:[29]})])]),_:1}),t(y,{class:"invoice-table-card",elevation:"3"},{default:a(()=>[e[61]||(e[61]=n("div",{class:"table-header pa-4 pa-sm-6"},[n("div",{class:"d-flex flex-column flex-sm-row align-start align-sm-center gap-4"},[n("div",null,[n("h2",{class:"text-h6 text-sm-h5 font-weight-bold mb-1"},"Daftar Tagihan"),n("p",{class:"text-body-2 text-medium-emphasis mb-0"}," Kelola dan pantau status pembayaran ")])])],-1)),t($e,null,{default:a(()=>[w.value.length>0?(_(),T("div",da,[n("span",ra,u(w.value.length)+" invoice terpilih",1),t(g),t(v,{color:"error",variant:"tonal","prepend-icon":"mdi-delete-sweep",onClick:e[5]||(e[5]=l=>z.value=!0)},{default:a(()=>e[31]||(e[31]=[o(" Hapus ")])),_:1,__:[31]})])):x("",!0)]),_:1}),n("div",ua,[t(Xe,{modelValue:w.value,"onUpdate:modelValue":e[8]||(e[8]=l=>w.value=l),headers:Ue,items:ie.value,loading:A.value,"item-value":"id",class:"invoice-table","items-per-page":15,"loading-text":"Memuat data invoice...","no-data-text":"Tidak ada data invoice","show-select":"","return-object":""},{loading:a(()=>[n("div",ca,[t(Ve,{indeterminate:"",color:"primary"}),e[32]||(e[32]=n("p",{class:"mt-4 text-medium-emphasis"},"Memuat data invoice...",-1))])]),"item.invoice_number":a(({item:l})=>[n("div",va,[n("div",ma,u(l.invoice_number),1),n("div",pa,[t(r,{size:"12",class:"me-1"},{default:a(()=>e[33]||(e[33]=[o("mdi-calendar")])),_:1,__:[33]}),o(" "+u(Y(l.tgl_invoice)),1)])])]),"item.pelanggan_id":a(({item:l})=>[n("div",_a,[n("div",fa,[t(Qe,{size:"32",color:"primary",class:"me-2"},{default:a(()=>[t(r,{color:"white",size:"16"},{default:a(()=>e[34]||(e[34]=[o("mdi-account")])),_:1,__:[34]})]),_:1}),n("div",null,[n("div",ga,u(ve(l.pelanggan_id)),1),n("div",ya,[t(r,{size:"12",class:"me-1"},{default:a(()=>e[35]||(e[35]=[o("mdi-identifier")])),_:1,__:[35]}),o(" ID: "+u(l.id_pelanggan),1)])])])])]),"item.total_harga":a(({item:l})=>[n("div",ba,[n("span",xa,u(oe(l.total_harga)),1)])]),"item.status_invoice":a(({item:l})=>[t(Ce,{color:me(l.status_invoice),variant:"elevated",size:"small",class:"font-weight-bold status-chip","prepend-icon":Me(l.status_invoice)},{default:a(()=>[o(u(l.status_invoice),1)]),_:2},1032,["color","prepend-icon"])]),"item.tgl_jatuh_tempo":a(({item:l})=>[n("div",wa,[n("div",ka,u(Y(l.tgl_jatuh_tempo)),1),l.status_invoice!=="Lunas"?(_(),T("div",{key:0,class:Le(["text-caption",l.status_invoice==="Kadaluarsa"?"text-error":"text-warning"])},u(pe(l)),3)):x("",!0)])]),"item.actions":a(({item:l})=>[n("div",ha,[t(D,{location:"top"},{activator:a(({props:m})=>[t(v,$({icon:""},m,{variant:"text",size:"small",color:"primary",onClick:L=>ye(l.payment_link),disabled:!l.payment_link,class:"action-btn"}),{default:a(()=>[t(r,null,{default:a(()=>e[36]||(e[36]=[o("mdi-content-copy")])),_:1,__:[36]})]),_:2},1040,["onClick","disabled"])]),default:a(()=>[e[37]||(e[37]=n("span",null,"Salin Link",-1))]),_:2,__:[37]},1024),t(D,{location:"top"},{activator:a(({props:m})=>[t(v,$({icon:"mdi-whatsapp"},m,{variant:"text",size:"small",color:"green",onClick:L=>_e(l),disabled:!l.payment_link||!l.no_telp}),null,16,["onClick","disabled"])]),default:a(()=>[e[38]||(e[38]=n("span",null,"Kirim Pengingat WhatsApp",-1))]),_:2,__:[38]},1024),t(D,{location:"top"},{activator:a(({props:m})=>[t(v,$({icon:"mdi-eye"},m,{variant:"text",size:"small",onClick:L=>se(l)}),null,16,["onClick"])]),default:a(()=>[e[39]||(e[39]=n("span",null,"Lihat Detail",-1))]),_:2,__:[39]},1024),t(D,{location:"top"},{activator:a(({props:m})=>[X(C).hasPermission("delete_invoices")?(_(),V(v,$({key:0,icon:"mdi-delete"},m,{variant:"text",size:"small",color:"error",onClick:L=>be(l),class:"action-btn"}),null,16,["onClick"])):x("",!0)]),default:a(()=>[e[40]||(e[40]=n("span",null,"Hapus",-1))]),_:2,__:[40]},1024),X(C).hasPermission("edit_invoices")?(_(),V(D,{key:0,location:"top"},{activator:a(({props:m})=>[l.status_invoice!=="Lunas"?(_(),V(v,$({key:0,icon:"mdi-check-decagram"},m,{variant:"text",size:"small",color:"success",onClick:L=>we(l)}),null,16,["onClick"])):x("",!0)]),default:a(()=>[e[41]||(e[41]=n("span",null,"Tandai Lunas",-1))]),_:2,__:[41]},1024)):x("",!0),t(te,{modelValue:F.value,"onUpdate:modelValue":e[7]||(e[7]=m=>F.value=m),"max-width":"500px",persistent:""},{default:a(()=>[t(y,null,{default:a(()=>[t(de,{class:"text-h5"},{default:a(()=>e[42]||(e[42]=[o("Tandai Lunas?")])),_:1,__:[42]}),t(ee,null,{default:a(()=>[n("p",null,[e[43]||(e[43]=o("Anda akan menandai invoice ")),n("strong",null,u(U.value?.invoice_number),1),e[44]||(e[44]=o(" sebagai lunas."))]),t(De,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=m=>B.value=m),items:["Cash","Bank Transfer","Lainnya"],label:"Metode Pembayaran",variant:"outlined",density:"compact",class:"mt-4"},null,8,["modelValue"])]),_:1}),t(Q,null,{default:a(()=>[t(g),t(v,{text:"",onClick:ke},{default:a(()=>e[45]||(e[45]=[o("Batal")])),_:1,__:[45]}),t(v,{color:"success",onClick:Ye,loading:O.value},{default:a(()=>e[46]||(e[46]=[o(" Konfirmasi ")])),_:1,__:[46]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","items","loading"])]),n("div",Da,[A.value?(_(),T("div",$a,[t(Ve,{indeterminate:"",color:"primary"}),e[47]||(e[47]=n("p",{class:"mt-4 text-medium-emphasis"},"Memuat data invoice...",-1))])):ie.value.length?(_(),T("div",Ca,[(_(!0),T(dt,null,rt(ie.value,l=>(_(),V(y,{key:l.id,class:"invoice-card-mobile mb-4",elevation:"2"},{default:a(()=>[n("div",Ia,[t(Ze,{modelValue:w.value,"onUpdate:modelValue":e[9]||(e[9]=m=>w.value=m),value:l,multiple:"","hide-details":"",class:"flex-grow-0"},null,8,["modelValue","value"]),n("div",{class:"ms-2 flex-grow-1",onClick:m=>se(l)},[n("div",Ta,u(l.invoice_number),1),n("div",Pa,u(ve(l.pelanggan_id)),1)],8,La),t(Ce,{color:me(l.status_invoice),variant:"elevated",size:"small",class:"font-weight-bold ms-2 me-2",label:""},{default:a(()=>[o(u(l.status_invoice),1)]),_:2},1032,["color"])]),t(Ie),t(et,{density:"compact",class:"py-2 px-4"},{default:a(()=>[t(ue,{class:"px-0"},{prepend:a(()=>[t(r,{color:"success",class:"me-4"},{default:a(()=>e[50]||(e[50]=[o("mdi-cash-multiple")])),_:1,__:[50]})]),append:a(()=>[n("span",za,u(oe(l.total_harga)),1)]),default:a(()=>[t(re,null,{default:a(()=>e[51]||(e[51]=[o("Total Tagihan")])),_:1,__:[51]})]),_:2},1024),t(ue,{class:"px-0"},{prepend:a(()=>[t(r,{color:"grey",class:"me-4"},{default:a(()=>e[52]||(e[52]=[o("mdi-calendar-start")])),_:1,__:[52]})]),append:a(()=>[n("span",null,u(Y(l.tgl_invoice)),1)]),default:a(()=>[t(re,null,{default:a(()=>e[53]||(e[53]=[o("Tgl. Invoice")])),_:1,__:[53]})]),_:2},1024),t(ue,{class:"px-0"},{prepend:a(()=>[t(r,{color:l.status_invoice==="Kadaluarsa"?"error":"warning",class:"me-4"},{default:a(()=>e[54]||(e[54]=[o("mdi-calendar-alert")])),_:2,__:[54]},1032,["color"])]),append:a(()=>[n("div",Ua,[n("div",null,u(Y(l.tgl_jatuh_tempo)),1),l.status_invoice!=="Lunas"?(_(),T("div",{key:0,class:Le(["text-caption",l.status_invoice==="Kadaluarsa"?"text-error":"text-warning"])},u(pe(l)),3)):x("",!0)])]),default:a(()=>[t(re,null,{default:a(()=>e[55]||(e[55]=[o("Jatuh Tempo")])),_:1,__:[55]})]),_:2},1024)]),_:2},1024),t(Ie),t(Q,{class:"justify-space-between pa-1"},{default:a(()=>[t(D,{text:"Salin Link"},{activator:a(({props:m})=>[t(v,$({ref_for:!0},m,{icon:"",variant:"text",size:"small",color:"primary",onClick:L=>ye(l.payment_link),disabled:!l.payment_link}),{default:a(()=>[t(r,null,{default:a(()=>e[56]||(e[56]=[o("mdi-content-copy")])),_:1,__:[56]})]),_:2},1040,["onClick","disabled"])]),_:2},1024),t(D,{text:"Kirim WA"},{activator:a(({props:m})=>[t(v,$({ref_for:!0},m,{icon:"",variant:"text",size:"small",color:"green",onClick:L=>_e(l),disabled:!l.payment_link||!l.no_telp}),{default:a(()=>[t(r,null,{default:a(()=>e[57]||(e[57]=[o("mdi-whatsapp")])),_:1,__:[57]})]),_:2},1040,["onClick","disabled"])]),_:2},1024),t(D,{text:"Lihat Detail"},{activator:a(({props:m})=>[t(v,$({ref_for:!0},m,{icon:"",variant:"text",size:"small",onClick:L=>se(l)}),{default:a(()=>[t(r,null,{default:a(()=>e[58]||(e[58]=[o("mdi-eye")])),_:1,__:[58]})]),_:2},1040,["onClick"])]),_:2},1024),X(C).hasPermission("edit_invoices")&&l.status_invoice!=="Lunas"?(_(),V(D,{key:0,text:"Tandai Lunas"},{activator:a(({props:m})=>[t(v,$({ref_for:!0},m,{icon:"",variant:"text",size:"small",color:"success",onClick:L=>we(l)}),{default:a(()=>[t(r,null,{default:a(()=>e[59]||(e[59]=[o("mdi-check-decagram")])),_:1,__:[59]})]),_:2},1040,["onClick"])]),_:2},1024)):x("",!0),X(C).hasPermission("delete_invoices")?(_(),V(D,{key:1,text:"Hapus"},{activator:a(({props:m})=>[t(v,$({ref_for:!0},m,{icon:"",variant:"text",size:"small",color:"error",onClick:L=>be(l)}),{default:a(()=>[t(r,null,{default:a(()=>e[60]||(e[60]=[o("mdi-delete")])),_:1,__:[60]})]),_:2},1040,["onClick"])]),_:2},1024)):x("",!0)]),_:2},1024)]),_:2},1024))),128))])):(_(),T("div",Va,[t(r,{size:"48",class:"text-disabled mb-4"},{default:a(()=>e[48]||(e[48]=[o("mdi-receipt-text-remove-outline")])),_:1,__:[48]}),e[49]||(e[49]=n("p",{class:"text-medium-emphasis"},"Tidak ada data invoice ditemukan",-1))]))])]),_:1,__:[61]}),t(te,{modelValue:M.value,"onUpdate:modelValue":e[10]||(e[10]=l=>M.value=l),"max-width":"500px",persistent:""},{default:a(()=>[t(y,null,{default:a(()=>[t(de,{class:"text-h5"},{default:a(()=>e[62]||(e[62]=[o("Konfirmasi Hapus")])),_:1,__:[62]}),t(ee,null,{default:a(()=>[e[63]||(e[63]=o(" Anda yakin ingin menghapus invoice ")),n("strong",null,u(P.value?.invoice_number),1),e[64]||(e[64]=o(" secara permanen? "))]),_:1,__:[63,64]}),t(Q,null,{default:a(()=>[t(g),t(v,{text:"",onClick:xe},{default:a(()=>e[65]||(e[65]=[o("Batal")])),_:1,__:[65]}),t(v,{color:"error",loading:I.value,onClick:We},{default:a(()=>e[66]||(e[66]=[o(" Ya, Hapus ")])),_:1,__:[66]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(te,{modelValue:s.value,"onUpdate:modelValue":e[12]||(e[12]=l=>s.value=l),"max-width":"600px",persistent:""},{default:a(()=>[t(y,{class:"generate-dialog"},{default:a(()=>[e[73]||(e[73]=n("div",{class:"dialog-header pa-6"},[n("h2",{class:"text-h5 font-weight-bold text-white mb-1"},"Buat Invoice Manual"),n("p",{class:"text-body-2 text-white text-opacity-90 mb-0"}," Pilih langganan pelanggan untuk membuat invoice baru ")],-1)),t(ee,{class:"pa-6"},{default:a(()=>[n("div",Ba,[t(r,{color:"info",class:"me-2"},{default:a(()=>e[67]||(e[67]=[o("mdi-information")])),_:1,__:[67]}),e[68]||(e[68]=n("span",{class:"text-body-2 text-medium-emphasis"}," Pilih langganan pelanggan yang ingin dibuatkan invoice-nya sekarang. ",-1))]),t(tt,{modelValue:f.value,"onUpdate:modelValue":e[11]||(e[11]=l=>f.value=l),items:Ne.value,"item-title":"title","item-value":"id",label:"Pilih Langganan Pelanggan",placeholder:"Ketik nama pelanggan atau ID langganan...",variant:"outlined",density:"comfortable",clearable:"","prepend-inner-icon":"mdi-account-search",class:"mb-4"},null,8,["modelValue","items"]),t($e,null,{default:a(()=>[le.value?(_(),T("div",Na,[t(he,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(q,{"model-value":oe(le.value.harga_awal),label:"Harga Sesuai Langganan",variant:"outlined",readonly:"","prepend-inner-icon":"mdi-cash"},null,8,["model-value"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(q,{"model-value":Y(le.value.tgl_jatuh_tempo),label:"Jatuh Tempo",variant:"outlined",readonly:"","prepend-inner-icon":"mdi-calendar-end"},null,8,["model-value"])]),_:1})]),_:1}),e[69]||(e[69]=n("p",{class:"text-caption text-medium-emphasis mt-n2"}," * Total tagihan akhir akan ditambahkan pajak sesuai brand. ",-1))])):x("",!0)]),_:1})]),_:1}),t(Q,{class:"pa-6 pt-0"},{default:a(()=>[t(g),t(v,{variant:"outlined",onClick:ge,size:"large",class:"text-none"},{default:a(()=>e[70]||(e[70]=[o(" Batal ")])),_:1,__:[70]}),t(v,{color:"primary",onClick:Ge,loading:J.value,disabled:!f.value,variant:"elevated",size:"large",class:"text-none font-weight-bold"},{default:a(()=>[t(r,{class:"me-2"},{default:a(()=>e[71]||(e[71]=[o("mdi-plus")])),_:1,__:[71]}),e[72]||(e[72]=o(" Buat Invoice "))]),_:1,__:[72]},8,["loading","disabled"])]),_:1})]),_:1,__:[73]})]),_:1},8,["modelValue"]),t(te,{modelValue:z.value,"onUpdate:modelValue":e[14]||(e[14]=l=>z.value=l),"max-width":"500px",persistent:""},{default:a(()=>[t(y,{class:"rounded-xl"},{default:a(()=>[t(de,{class:"text-h5 d-flex align-center bg-error"},{default:a(()=>[t(r,{start:""},{default:a(()=>e[74]||(e[74]=[o("mdi-delete-alert")])),_:1,__:[74]}),e[75]||(e[75]=o(" Konfirmasi Hapus Massal "))]),_:1,__:[75]}),t(ee,{class:"pt-6"},{default:a(()=>[e[76]||(e[76]=o(" Anda yakin ingin menghapus ")),n("strong",null,u(w.value.length)+" invoice",1),e[77]||(e[77]=o(" yang dipilih? Tindakan ini tidak dapat dibatalkan. "))]),_:1,__:[76,77]}),t(Q,null,{default:a(()=>[t(g),t(v,{text:"",onClick:e[13]||(e[13]=l=>z.value=!1)},{default:a(()=>e[78]||(e[78]=[o("Batal")])),_:1,__:[78]}),t(v,{color:"error",variant:"flat",onClick:Oe,loading:I.value},{default:a(()=>e[79]||(e[79]=[o(" Ya, Hapus ")])),_:1,__:[79]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(at,{modelValue:b.value.show,"onUpdate:modelValue":e[16]||(e[16]=l=>b.value.show=l),color:b.value.color,timeout:4e3,location:"top right",variant:"elevated",class:"custom-snackbar"},{actions:a(()=>[t(v,{variant:"text",onClick:e[15]||(e[15]=l=>b.value.show=!1),icon:"mdi-close",size:"small"})]),default:a(()=>[n("div",Sa,[t(r,{class:"me-2"},{default:a(()=>[o(u(Je(b.value.color)),1)]),_:1}),o(" "+u(b.value.text),1)])]),_:1},8,["modelValue","color"]),t(Rt,{modelValue:W.value,"onUpdate:modelValue":e[17]||(e[17]=l=>W.value=l),invoice:Z.value},null,8,["modelValue","invoice"])]),_:1})}}}),Fa=Pe(Ka,[["__scopeId","data-v-06809d13"]]);export{Fa as default};
